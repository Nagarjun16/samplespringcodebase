<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.23" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 4.6.0.v201606072122</property>
    <property name="units">in</property>
    <property name="iconFile">/templates/blank_report.gif</property>
    <property name="bidiLayoutOrientation">ltr</property>
    <property name="imageDPI">144</property>
    <parameters>
        <scalar-parameter name="fromDate" id="152">
            <property name="valueType">static</property>
            <property name="isRequired">true</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="toDate" id="153">
            <property name="valueType">static</property>
            <property name="isRequired">true</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="type" id="180">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="referenceNo" id="181">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="carrierCode" id="182">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="carrierGp" id="183">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="shcGroupCode" id="184">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <oda-data-source extensionID="org.eclipse.birt.report.data.oda.jdbc" name="Data Source" id="103">
            <list-property name="privateDriverProperties">
                <ex-property>
                    <name>metadataBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledMetadataBidiFormatStr</name>
                </ex-property>
                <ex-property>
                    <name>contentBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledContentBidiFormatStr</name>
                </ex-property>
            </list-property>
            <property name="odaDriverClass">com.microsoft.sqlserver.jdbc.SQLServerDriver</property>
            <property name="odaURL">jdbc:sqlserver://aisatsblr-cosysuatsqldb1server.database.windows.net;databaseName=NGCUAT_AISATSBLR</property>
            <property name="odaUser">SATsDevUser</property>
            <encrypted-property name="odaPassword" encryptionID="base64">U0B0cyMxNDIx</encrypted-property>
        </oda-data-source>
    </data-sources>
    <data-sets>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="Data Set" id="401">
            <property name="eventHandlerClass">com.ngen.cosys.report.event.DateTimeDataItemEventHandler</property>
            <list-property name="columnHints"/>
            <list-property name="parameters">
                <structure>
                    <property name="name">param_1</property>
                    <property name="paramName">fromDate</property>
                    <property name="nativeName"></property>
                    <property name="dataType">date</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">1</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_2</property>
                    <property name="paramName">toDate</property>
                    <property name="nativeName"></property>
                    <property name="dataType">date</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">2</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_3</property>
                    <property name="paramName">fromDate</property>
                    <property name="nativeName"></property>
                    <property name="dataType">date</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">3</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_4</property>
                    <property name="paramName">toDate</property>
                    <property name="nativeName"></property>
                    <property name="dataType">date</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">4</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">shcGroup</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">AGENT</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">ShipmentId</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">ShipmentHouseId</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">ShipmentNumber</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">HouseNumber</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">IGMNumber</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">IGMDate</property>
                        <property name="dataType">date-time</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">BOENumber</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">BOEDate</property>
                        <property name="dataType">date</property>
                    </structure>
                    <structure>
                        <property name="position">11</property>
                        <property name="name">OC</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">12</property>
                        <property name="name">NOG</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">13</property>
                        <property name="name">MAWBCNE</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">14</property>
                        <property name="name">HAWBCNE</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">15</property>
                        <property name="name">FlightKey</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">16</property>
                        <property name="name">FlightDate</property>
                        <property name="dataType">date-time</property>
                    </structure>
                    <structure>
                        <property name="position">17</property>
                        <property name="name">IrregularityPieces</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">18</property>
                        <property name="name">IrregularityWeight</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">19</property>
                        <property name="name">CreatedDateTime</property>
                        <property name="dataType">date-time</property>
                    </structure>
                </list-property>
            </structure>
            <method name="beforeOpen"><![CDATA[var carrierGp = params["carrierGp"].value;
var type = params["type"].value;
var referenceNo = params["referenceNo"].value;
var carrierCode = params["carrierCode"].value;

if(params["carrierGp"].value != null &amp;&amp; params["carrierGp"].value != ""){
this.queryText = this.queryText +" and( (SUBSTRING(Com_TracingShipmentInfo.FlightKey,1,2) "
this.queryText = this.queryText +" in (select "
this.queryText = this.queryText +" Mst_AssociateCarrierWithGroup.CarrierCode "
this.queryText = this.queryText +" from "
this.queryText = this.queryText +" Mst_AssociateCarrierWithGroup, Mst_CarrierGroup"
this.queryText = this.queryText +" where"
this.queryText = this.queryText +" Mst_AssociateCarrierWithGroup.Mst_CarrierGroup_ID = Mst_CarrierGroup.Mst_CarrierGroup_ID and"
this.queryText = this.queryText +" Mst_CarrierGroup.CarrierGroupCode ='"+ params["carrierGp"].value +"'))"
this.queryText = this.queryText +" OR(SUBSTRING(Com_TracingShipmentInfo.FlightKey,1,3) "
this.queryText = this.queryText +" in (select "
this.queryText = this.queryText +" Mst_AssociateCarrierWithGroup.CarrierCode"
this.queryText = this.queryText +" from"
this.queryText = this.queryText +" Mst_AssociateCarrierWithGroup, Mst_CarrierGroup "
this.queryText = this.queryText +" where"
this.queryText = this.queryText +" Mst_AssociateCarrierWithGroup.Mst_CarrierGroup_ID = Mst_CarrierGroup.Mst_CarrierGroup_ID and"
this.queryText = this.queryText +" Mst_CarrierGroup.CarrierGroupCode ='"+ params["carrierGp"].value +"')))"}if(type != null &amp;&amp; type != ""){
this.queryText = this.queryText +" AND ImportExportIndicator = '"+ type +"'"
}
if(referenceNo != null &amp;&amp; referenceNo != ""){
this.queryText = this.queryText +" AND Com_TracingShipmentInfo.ShipmentNumber ='"+ referenceNo +"'"
}
if(carrierCode != null &amp;&amp; carrierCode != ""){
this.queryText = this.queryText +" AND Com_TracingShipmentInfo.CarrierCode ='"+ carrierCode +"'"
}
this.queryText = this.queryText + "Order BY Com_TracingShipmentInfo.CreatedDateTime DESC"
]]></method>
            <property name="dataSource">Data Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">shcGroup</property>
                    <property name="nativeName">shcGroup</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">AGENT</property>
                    <property name="nativeName">AGENT</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">ShipmentId</property>
                    <property name="nativeName">ShipmentId</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">ShipmentHouseId</property>
                    <property name="nativeName">ShipmentHouseId</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">ShipmentNumber</property>
                    <property name="nativeName">ShipmentNumber</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">HouseNumber</property>
                    <property name="nativeName">HouseNumber</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">7</property>
                    <property name="name">IGMNumber</property>
                    <property name="nativeName">IGMNumber</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">8</property>
                    <property name="name">IGMDate</property>
                    <property name="nativeName">IGMDate</property>
                    <property name="dataType">date-time</property>
                </structure>
                <structure>
                    <property name="position">9</property>
                    <property name="name">BOENumber</property>
                    <property name="nativeName">BOENumber</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">10</property>
                    <property name="name">BOEDate</property>
                    <property name="nativeName">BOEDate</property>
                    <property name="dataType">date</property>
                </structure>
                <structure>
                    <property name="position">11</property>
                    <property name="name">OC</property>
                    <property name="nativeName">OC</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">12</property>
                    <property name="name">NOG</property>
                    <property name="nativeName">NOG</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">13</property>
                    <property name="name">MAWBCNE</property>
                    <property name="nativeName">MAWBCNE</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">14</property>
                    <property name="name">HAWBCNE</property>
                    <property name="nativeName">HAWBCNE</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">15</property>
                    <property name="name">FlightKey</property>
                    <property name="nativeName">FlightKey</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">16</property>
                    <property name="name">FlightDate</property>
                    <property name="nativeName">FlightDate</property>
                    <property name="dataType">date-time</property>
                </structure>
                <structure>
                    <property name="position">17</property>
                    <property name="name">IrregularityPieces</property>
                    <property name="nativeName">IrregularityPieces</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">18</property>
                    <property name="name">IrregularityWeight</property>
                    <property name="nativeName">IrregularityWeight</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">19</property>
                    <property name="name">CreatedDateTime</property>
                    <property name="nativeName">CreatedDateTime</property>
                    <property name="dataType">date-time</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[with SHCGrp as (
 select string_agg(Mst_SHCGroupCollection.SHCGroupCollectionCode, ',') SHCGroupCollectionCode,
              Mst_SpecialHandlingCode.SpecialHandlingCode as specialHandlingCode,
              string_agg(Mst_SHCHandlingGroup.SHCHandlingGroupCode, ',') as SHCHandlingGroupCode

      from    
       Mst_SHCHandlingGroup
          inner join Mst_AssociateSHCByHandlingGroup on
		  Mst_AssociateSHCByHandlingGroup.MstSHCHandlingGroupID = Mst_SHCHandlingGroup.MstSHCHandlingGroupID          
            inner join Mst_SpecialHandlingCode
           	on Mst_AssociateSHCByHandlingGroup.SpecialHandlingCode=Mst_SpecialHandlingCode.SpecialHandlingCode
            inner join          
          Mst_SHCGroupCollectionItems ON
          Mst_SHCGroupCollectionItems.SHCHandlingGroupCode=Mst_SHCHandlingGroup.SHCHandlingGroupCode
          inner join Mst_SHCGroupCollection  ON
		  Mst_SHCGroupCollection.MstSHCGroupCollectionId=Mst_SHCGroupCollectionItems.MstSHCGroupCollectionId
          where
              Mst_SHCHandlingGroup.Category in ('DOC', 'WH')
                group by
              Mst_SpecialHandlingCode.SpecialHandlingCode


),

tracing  as (
select MAX(ComTracingShipmentInfoId) tracingid,Com_TracingShipmentInfo.ShipmentNumber ,
null as HouseNumber from Com_TracingShipmentInfo
inner join Shipment_Master
on Com_TracingShipmentInfo.ShipmentNumber=Shipment_Master.ShipmentNumber
where Com_TracingShipmentInfo.CaseStatus='MOVETOABANDON'
and Com_TracingShipmentInfo.HouseNumber is null
group by Com_TracingShipmentInfo.ShipmentNumber
 
 UNION 

select MAX(ComTracingShipmentInfoId) tracingid,Com_TracingShipmentInfo.ShipmentNumber,
Com_TracingShipmentInfo.HouseNumber
from Com_TracingShipmentInfo
inner join Shipment_Master
on Com_TracingShipmentInfo.ShipmentNumber=Shipment_Master.ShipmentNumber  
where Com_TracingShipmentInfo.CaseStatus='MOVETOABANDON'
and Com_TracingShipmentInfo.HouseNumber is not null
group by Com_TracingShipmentInfo.ShipmentNumber ,
Com_TracingShipmentInfo.HouseNumber

)



select distinct
case
when
Com_TracingShipmentInfo.HouseNumber is null then
(      select
                            
                            STRING_AGG( SHCGrp.SHCGroupCollectionCode,',')
                             from
                             Shipment_Master sm inner join
                             Shipment_MasterSHC
                                    on sm.ShipmentId = Shipment_MasterSHC.ShipmentId 
                                    inner join SHCGrp
									ON SHCGrp.specialHandlingCode=Shipment_MasterSHC.SpecialHandlingCode                                    
                where 
				 sm.ShipmentId=Shipment_Master.ShipmentId
				
) 
else

(
  select
                                STRING_AGG( SHCGrp.SHCGroupCollectionCode,',')    
                             from
                             Shipment_Master sm
                             inner join
							 Shipment_HouseInformation shi
							 on sm.ShipmentId = shi.ShipmentId 
							  inner join
                             Shipment_HouseSHC
                             on shi.ShipmentHouseId= Shipment_HouseSHC.ShipmentHouseId 
                             inner join SHCGrp
							 ON SHCGrp.specialHandlingCode=Shipment_HouseSHC.SpecialHandlingCode
                             where sm.shipmentid=Shipment_Master.ShipmentId
                             and shi.number=Com_TracingShipmentInfo.HouseNumber
                             and Com_TracingShipmentInfo.ShipmentNumber=sm.ShipmentNumber
                             and Com_TracingShipmentInfo.ShipmentDate=sm.ShipmentDate
) end as shcGroup,
	case
when
inv.number is null then
(
	select Customer_Master.CustomerCode 
	from 
		Shipment_MasterCustomerInfo inner join
		Customer_Master
	on Shipment_MasterCustomerInfo.AppointedAgent = Customer_Master.Customer_ID
	where 
		CustomerType='CNE' 
		and Shipment_MasterCustomerInfo.ShipmentId = Shipment_Master.ShipmentId) 
else
(
	select Customer_Master.CustomerCode 
	from 
		Shipment_HouseCustomerInfo inner join
		Customer_Master
	on Shipment_HouseCustomerInfo.AppointedAgent = Customer_Master.Customer_ID
	where 
		CustomerType='CNE' 
		and Shipment_HouseCustomerInfo.ShipmentHouseId = inv.ShipmentHouseId) 
end as AGENT,
Shipment_Master.ShipmentId,
inv.ShipmentHouseId,
Shipment_Master.ShipmentNumber,
inv.Number as HouseNumber,
(select top 1 CustomsFlightNumber from Flt_OperativeFlight_Attributes
INNER JOIN Flt_OperativeFlight ON Flt_OperativeFlight_Attributes.Flight_ID=Flt_OperativeFlight.Flight_ID
INNER JOIN Flt_OperativeFlight_Legs ON Flt_OperativeFlight_Legs.Flight_ID=Flt_OperativeFlight.Flight_ID
and Flt_OperativeFlight_Legs.FlightOffPoint='BLR'
and Flt_OperativeFlight.flightkey=Com_TracingShipmentInfo.FlightKey
and cast(Flt_OperativeFlight_Legs.DateSTA as date)=cast(Com_TracingShipmentInfo.FlightDate as date))
as IGMNumber,
(select top 1 CustomsFlightDate from Flt_OperativeFlight_Attributes
INNER JOIN Flt_OperativeFlight ON Flt_OperativeFlight_Attributes.Flight_ID=Flt_OperativeFlight.Flight_ID
INNER JOIN Flt_OperativeFlight_Legs ON Flt_OperativeFlight_Legs.Flight_ID=Flt_OperativeFlight.Flight_ID
and Flt_OperativeFlight_Legs.FlightOffPoint='BLR'
and Flt_OperativeFlight.flightkey=Com_TracingShipmentInfo.FlightKey
and cast(Flt_OperativeFlight_Legs.DateSTA as date)=cast(Com_TracingShipmentInfo.FlightDate as date))
as IGMDate,
case
when
inv.Number is null
then
(Select top 1 CustomsImportDocumentNumber
from Customs_ImportShipment where ShipmentNumber=Com_TracingShipmentInfo.ShipmentNumber)
else
(Select top 1 CustomsImportDocumentNumber
from Customs_ImportShipment where ShipmentNumber=Com_TracingShipmentInfo.ShipmentNumber and HouseNumber=inv.Number)
end as BOENumber,
case
when
inv.Number is null
then
(Select top 1 CONVERT(DATE,CustomsImportDocumentDate)
from Customs_ImportShipment where ShipmentNumber=Com_TracingShipmentInfo.ShipmentNumber)
else
(Select top 1 CONVERT(DATE,CustomsImportDocumentDate)
from Customs_ImportShipment where ShipmentNumber=Com_TracingShipmentInfo.ShipmentNumber and HouseNumber=inv.Number)
end as BOEDate,
case
when
inv.Number is null
then
(Select top 1 CustomsClearanceNumber
from Customs_ImportShipment where ShipmentNumber=Com_TracingShipmentInfo.ShipmentNumber)
else
(Select top 1 CustomsClearanceNumber
from Customs_ImportShipment where ShipmentNumber=Com_TracingShipmentInfo.ShipmentNumber and HouseNumber=inv.Number)
end as OC,



case
when
inv.Number is null
then
Shipment_Master.NatureOfGoodsDescription
else
(select NatureOfGoodsDescription
from Shipment_HouseInformation
where ShipmentHouseId=inv.ShipmentHouseId)
end as NOG,

(select CustomerName from Shipment_MasterCustomerInfo where ShipmentId=Shipment_Master.ShipmentId and CustomerType='CNE') as MAWBCNE,
(select CustomerName from Shipment_HouseCustomerInfo where ShipmentHouseId=inv.ShipmentHouseId and CustomerType='CNE') as HAWBCNE,
Com_TracingShipmentInfo.FlightKey,
Com_TracingShipmentInfo.FlightDate,
inv.pieces IrregularityPieces ,
inv.weight IrregularityWeight,
Com_TracingShipmentInfo.CreatedDateTime

from
Shipment_Master
INNER JOIN
Com_TracingShipmentInfo

ON
Com_TracingShipmentInfo.ShipmentNumber=Shipment_Master.ShipmentNumber
and
Shipment_Master.ShipmentDate=Com_TracingShipmentInfo.ShipmentDate

inner join 
tracing 
on tracing.ShipmentNumber=Com_TracingShipmentInfo.ShipmentNumber
and (tracing.HouseNumber is null or tracing.HouseNumber=Com_TracingShipmentInfo.HouseNumber)
and tracing.tracingid = Com_TracingShipmentInfo.ComTracingShipmentInfoId

INNER JOIN (select Number,Shipment_Inventory.Shipment_Id shipmentId,Shipment_Inventory.ShipmentHouseId,
sum(Shipment_Inventory.pieces) pieces,sum(Shipment_Inventory.weight) weight
from
Shipment_Inventory Left JOIN shipment_houseInformation
ON Shipment_Inventory.ShipmentHouseId=shipment_houseInformation.ShipmentHouseId group by Number,Shipment_Inventory.Shipment_Id,Shipment_Inventory.ShipmentHouseId) inv
ON Shipment_Master.shipmentId=inv.shipmentId
and (inv.number = Com_TracingShipmentInfo.housenumber or Com_TracingShipmentInfo.housenumber is null)
where

Com_TracingShipmentInfo.CaseStatus='MOVETOABANDON' and
Shipment_Master.Abandoned=1
and Shipment_Master.Dispose=0
		and ((cast(Com_TracingShipmentInfo.CreatedDateTime as date)
				BETWEEN
				?
				AND
				?)
				OR
				(cast(Com_TracingShipmentInfo.LastUpdatedDateTime as date)
				BETWEEN
			    ?
				AND
				?))
				
	]]></xml-property>
        </oda-data-set>
    </data-sets>
    <styles>
        <style name="report" id="4">
            <property name="fontFamily">sans-serif</property>
            <property name="fontSize">10pt</property>
        </style>
        <style name="NewStyle" id="5">
            <property name="borderBottomStyle">solid</property>
            <property name="borderBottomWidth">thin</property>
            <property name="borderLeftStyle">solid</property>
            <property name="borderLeftWidth">thin</property>
            <property name="borderRightStyle">solid</property>
            <property name="borderRightWidth">thin</property>
            <property name="borderTopStyle">solid</property>
            <property name="borderTopWidth">thin</property>
            <structure name="dateTimeFormat">
                <property name="category">Custom</property>
                <property name="pattern">M/d/yy</property>
            </structure>
        </style>
        <style name="crosstab-cell" id="6">
            <property name="borderBottomColor">#CCCCCC</property>
            <property name="borderBottomStyle">solid</property>
            <property name="borderBottomWidth">1pt</property>
            <property name="borderLeftColor">#CCCCCC</property>
            <property name="borderLeftStyle">solid</property>
            <property name="borderLeftWidth">1pt</property>
            <property name="borderRightColor">#CCCCCC</property>
            <property name="borderRightStyle">solid</property>
            <property name="borderRightWidth">1pt</property>
            <property name="borderTopColor">#CCCCCC</property>
            <property name="borderTopStyle">solid</property>
            <property name="borderTopWidth">1pt</property>
        </style>
    </styles>
    <page-setup>
        <simple-master-page name="Simple MasterPage" id="2">
            <property name="type">custom</property>
            <property name="height">7in</property>
            <property name="width">35.182in</property>
        </simple-master-page>
    </page-setup>
    <body>
        <label id="371">
            <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
            <property name="fontWeight">bold</property>
            <property name="textAlign">center</property>
            <text-property name="text">g.list.abadoned.cargo</text-property>
        </label>
        <table id="1333">
            <property name="dataSet">Data Set</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">IGMNumber</property>
                    <text-property name="displayName">IGMNumber</text-property>
                    <expression name="expression" type="javascript">dataSetRow["IGMNumber"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">IGMDate</property>
                    <text-property name="displayName">IGMDate</text-property>
                    <expression name="expression" type="javascript">dataSetRow["IGMDate"]</expression>
                    <property name="dataType">date-time</property>
                </structure>
                <structure>
                    <property name="name">Aggregation</property>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">RUNNINGCOUNT</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">1</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">ShipmentNumber</property>
                    <text-property name="displayName">ShipmentNumber</text-property>
                    <expression name="expression" type="javascript">dataSetRow["ShipmentNumber"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">HouseNumber</property>
                    <text-property name="displayName">HouseNumber</text-property>
                    <expression name="expression" type="javascript">dataSetRow["HouseNumber"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">AGENT</property>
                    <text-property name="displayName">AGENT</text-property>
                    <expression name="expression" type="javascript">dataSetRow["AGENT"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">MAWBCNE</property>
                    <text-property name="displayName">MAWBCNE</text-property>
                    <expression name="expression" type="javascript">dataSetRow["MAWBCNE"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">HAWBCNE</property>
                    <text-property name="displayName">HAWBCNE</text-property>
                    <expression name="expression" type="javascript">dataSetRow["HAWBCNE"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">FlightKey</property>
                    <text-property name="displayName">FlightKey</text-property>
                    <expression name="expression" type="javascript">dataSetRow["FlightKey"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">FlightDate</property>
                    <text-property name="displayName">FlightDate</text-property>
                    <expression name="expression" type="javascript">dataSetRow["FlightDate"]</expression>
                    <property name="dataType">date-time</property>
                </structure>
                <structure>
                    <property name="name">IrregularityPieces</property>
                    <text-property name="displayName">IrregularityPieces</text-property>
                    <expression name="expression" type="javascript">dataSetRow["IrregularityPieces"]</expression>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="name">IrregularityWeight</property>
                    <text-property name="displayName">IrregularityWeight</text-property>
                    <expression name="expression" type="javascript">dataSetRow["IrregularityWeight"]</expression>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="name">NOG</property>
                    <text-property name="displayName">NOG</text-property>
                    <expression name="expression" type="javascript">dataSetRow["NOG"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">BOENumber</property>
                    <text-property name="displayName">BOENumber</text-property>
                    <expression name="expression" type="javascript">dataSetRow["BOENumber"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">BOEDate</property>
                    <text-property name="displayName">BOEDate</text-property>
                    <expression name="expression" type="javascript">dataSetRow["BOEDate"]</expression>
                    <property name="dataType">date-time</property>
                </structure>
                <structure>
                    <property name="name">OC</property>
                    <text-property name="displayName">OC</text-property>
                    <expression name="expression" type="javascript">dataSetRow["OC"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Column Binding</property>
                    <text-property name="displayName">shcGroup</text-property>
                    <expression name="expression" type="javascript">dataSetRow["shcGroup"]</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">shcGroup</property>
                    <text-property name="displayName">shcGroup</text-property>
                    <expression name="expression" type="javascript">dataSetRow["shcGroup"]</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">ShipmentId</property>
                    <text-property name="displayName">ShipmentId</text-property>
                    <expression name="expression" type="javascript">dataSetRow["ShipmentId"]</expression>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="name">ShipmentHouseId</property>
                    <text-property name="displayName">ShipmentHouseId</text-property>
                    <expression name="expression" type="javascript">dataSetRow["ShipmentHouseId"]</expression>
                    <property name="dataType">decimal</property>
                </structure>
            </list-property>
            <list-property name="sort">
                <structure>
                    <expression name="key" type="javascript">row["CreatedDateTime"]</expression>
                    <property name="direction">desc</property>
                    <property name="strength">-1</property>
                </structure>
            </list-property>
            <list-property name="filter">
                <structure>
                    <property name="operator">like</property>
                    <expression name="expr" type="javascript">if(params["shcGroupCode"].value !=null){row["shcGroup"]}</expression>
                    <simple-property-list name="value1">
                        <value>params["shcGroupCode"].value</value>
                    </simple-property-list>
                    <property name="updateAggregation">true</property>
                </structure>
            </list-property>
            <column id="1400"/>
            <column id="1401"/>
            <column id="1402"/>
            <column id="1403"/>
            <column id="1404"/>
            <column id="1405"/>
            <column id="1406"/>
            <column id="1407"/>
            <column id="1408"/>
            <column id="1409"/>
            <column id="1410"/>
            <column id="1411"/>
            <column id="1412"/>
            <column id="1413"/>
            <column id="1414"/>
            <column id="1415"/>
            <header>
                <row id="1334">
                    <cell id="1335">
                        <label id="1462">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                            <property name="fontWeight">bold</property>
                            <text-property name="text">g.sNo</text-property>
                        </label>
                    </cell>
                    <cell id="1336">
                        <label id="1421">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                            <property name="fontWeight">bold</property>
                            <text-property name="text">abandoned.igm.numbers</text-property>
                        </label>
                    </cell>
                    <cell id="1337">
                        <label id="1423">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                            <property name="fontWeight">bold</property>
                            <text-property name="text">imp.igm.date</text-property>
                        </label>
                    </cell>
                    <cell id="1338">
                        <label id="1426">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                            <property name="fontWeight">bold</property>
                            <text-property name="text">g.referenceNumber</text-property>
                        </label>
                    </cell>
                    <cell id="1339">
                        <label id="1428">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                            <property name="fontWeight">bold</property>
                            <text-property name="text">g.hawb.number</text-property>
                        </label>
                    </cell>
                    <cell id="1340">
                        <label id="1430">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                            <property name="fontWeight">bold</property>
                            <text-property name="text">agent</text-property>
                        </label>
                    </cell>
                    <cell id="1341">
                        <label id="1432">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                            <property name="fontWeight">bold</property>
                            <text-property name="text">g.mawb.cne</text-property>
                        </label>
                    </cell>
                    <cell id="1342">
                        <label id="1434">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                            <property name="fontWeight">bold</property>
                            <text-property name="text">g.hawb.cne</text-property>
                        </label>
                    </cell>
                    <cell id="1343">
                        <label id="1436">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                            <property name="fontWeight">bold</property>
                            <text-property name="text">flight.flightNumber</text-property>
                        </label>
                    </cell>
                    <cell id="1344">
                        <label id="1438">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                            <property name="fontWeight">bold</property>
                            <text-property name="text">g.FlightDate</text-property>
                        </label>
                    </cell>
                    <cell id="1345">
                        <label id="1440">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                            <property name="fontWeight">bold</property>
                            <text-property name="text">tracing.IrregularityPieces</text-property>
                        </label>
                    </cell>
                    <cell id="1346">
                        <label id="1442">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                            <property name="fontWeight">bold</property>
                            <text-property name="text">tracing.IrregularityWeight</text-property>
                        </label>
                    </cell>
                    <cell id="1347">
                        <label id="1444">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                            <property name="fontWeight">bold</property>
                            <text-property name="text">g.natureOfGoods</text-property>
                        </label>
                    </cell>
                    <cell id="1348">
                        <label id="1446">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                            <property name="fontWeight">bold</property>
                            <text-property name="text">import.boeNumber</text-property>
                        </label>
                    </cell>
                    <cell id="1349">
                        <label id="1448">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                            <property name="fontWeight">bold</property>
                            <text-property name="text">import.customs.import.document.date</text-property>
                        </label>
                    </cell>
                    <cell id="1350">
                        <label id="1450">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                            <property name="fontWeight">bold</property>
                            <text-property name="text">g.oc.number</text-property>
                        </label>
                    </cell>
                </row>
            </header>
            <detail>
                <row id="1356">
                    <property name="height">0.5972222222222222in</property>
                    <cell id="1357">
                        <data id="1425">
                            <property name="resultSetColumn">Aggregation</property>
                        </data>
                    </cell>
                    <cell id="1358">
                        <data id="1422">
                            <property name="resultSetColumn">IGMNumber</property>
                        </data>
                    </cell>
                    <cell id="1359">
                        <data id="1424">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.DateTimeDataItemEventHandler</property>
                            <property name="resultSetColumn">IGMDate</property>
                        </data>
                    </cell>
                    <cell id="1360">
                        <data id="1427">
                            <property name="resultSetColumn">ShipmentNumber</property>
                        </data>
                    </cell>
                    <cell id="1361">
                        <data id="1429">
                            <property name="resultSetColumn">HouseNumber</property>
                        </data>
                    </cell>
                    <cell id="1362">
                        <data id="1431">
                            <property name="resultSetColumn">AGENT</property>
                        </data>
                    </cell>
                    <cell id="1363">
                        <data id="1433">
                            <property name="resultSetColumn">MAWBCNE</property>
                        </data>
                    </cell>
                    <cell id="1364">
                        <data id="1435">
                            <property name="resultSetColumn">HAWBCNE</property>
                        </data>
                    </cell>
                    <cell id="1365">
                        <data id="1437">
                            <property name="resultSetColumn">FlightKey</property>
                        </data>
                    </cell>
                    <cell id="1366">
                        <data id="1439">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.DateTimeDataItemEventHandler</property>
                            <property name="resultSetColumn">FlightDate</property>
                        </data>
                    </cell>
                    <cell id="1367">
                        <data id="1441">
                            <property name="resultSetColumn">IrregularityPieces</property>
                        </data>
                    </cell>
                    <cell id="1368">
                        <data id="1443">
                            <property name="resultSetColumn">IrregularityWeight</property>
                        </data>
                    </cell>
                    <cell id="1369">
                        <data id="1445">
                            <property name="resultSetColumn">NOG</property>
                        </data>
                    </cell>
                    <cell id="1370">
                        <data id="1447">
                            <property name="resultSetColumn">BOENumber</property>
                        </data>
                    </cell>
                    <cell id="1371">
                        <data id="1449">
                            <property name="eventHandlerClass">com.ngen.cosys.report.event.DateDataItemEventHandler</property>
                            <property name="resultSetColumn">BOEDate</property>
                        </data>
                    </cell>
                    <cell id="1372">
                        <data id="1451">
                            <property name="resultSetColumn">OC</property>
                        </data>
                    </cell>
                </row>
            </detail>
            <footer>
                <row id="1378">
                    <property name="height">0.7013888888888888in</property>
                    <cell id="1379"/>
                    <cell id="1380"/>
                    <cell id="1381"/>
                    <cell id="1382"/>
                    <cell id="1383"/>
                    <cell id="1384"/>
                    <cell id="1385"/>
                    <cell id="1386"/>
                    <cell id="1387"/>
                    <cell id="1388"/>
                    <cell id="1389"/>
                    <cell id="1390"/>
                    <cell id="1391"/>
                    <cell id="1392"/>
                    <cell id="1393"/>
                    <cell id="1394"/>
                </row>
            </footer>
        </table>
    </body>
</report>
