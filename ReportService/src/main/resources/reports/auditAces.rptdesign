<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.23" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 4.6.0.v201606072122</property>
    <property name="units">in</property>
    <property name="iconFile">/templates/blank_report.gif</property>
    <property name="bidiLayoutOrientation">ltr</property>
    <property name="imageDPI">96</property>
    <parameters>
        <scalar-parameter name="awb" id="4206">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="tenantCurrentDateTime" id="4208">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <oda-data-source extensionID="org.eclipse.birt.report.data.oda.jdbc" name="Data Source" id="257">
            <list-property name="privateDriverProperties">
                <ex-property>
                    <name>metadataBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledMetadataBidiFormatStr</name>
                </ex-property>
                <ex-property>
                    <name>contentBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledContentBidiFormatStr</name>
                </ex-property>
            </list-property>
            <property name="odaDriverClass">com.microsoft.sqlserver.jdbc.SQLServerDriver</property>
            <property name="odaURL">jdbc:sqlserver://cosysuatsqldb1server.database.windows.net;databaseName=NGCDEV</property>
            <property name="odaUser">SATsDevUser</property>
            <encrypted-property name="odaPassword" encryptionID="base64">U0B0cyMxNDIx</encrypted-property>
        </oda-data-source>
    </data-sources>
    <data-sets>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.SPSelectDataSet" name="Data Set1" id="280">
            <list-property name="columnHints"/>
            <list-property name="parameters">
                <structure>
                    <property name="name">param_1</property>
                    <property name="paramName">awb</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">1</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">EventId</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">EventDateTime</property>
                        <property name="dataType">date-time</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">Actor</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">EventName</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">EventAction</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">EntityType</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">EntityValue</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">EventValue</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">EventId</property>
                    <property name="nativeName">EventId</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">EventDateTime</property>
                    <property name="nativeName">EventDateTime</property>
                    <property name="dataType">date-time</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">Actor</property>
                    <property name="nativeName">Actor</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">EventName</property>
                    <property name="nativeName">EventName</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">EventAction</property>
                    <property name="nativeName">EventAction</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">EntityType</property>
                    <property name="nativeName">EntityType</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">7</property>
                    <property name="name">EntityValue</property>
                    <property name="nativeName">EntityValue</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">8</property>
                    <property name="name">EventValue</property>
                    <property name="nativeName">EventValue</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[
DECLARE @Audits TABLE (EventId NUMERIC, EventDateTime DATETIME, Actor VARCHAR(200), EventName VARCHAR(200), EventAction VARCHAR(6), EntityType VARCHAR(100), EntityValue VARCHAR(200), EventValue NVARCHAR(max))
		DECLARE @IndexedEntityAttributes TABLE (EntityAttribute VARCHAR(100), EntityAttributeName VARCHAR(100))
		DECLARE @FinalEntityAttributes TABLE (EntityType VARCHAR(100), EntityAttribute VARCHAR(100), EntityAttributeName VARCHAR(50), EntityAttributeType NUMERIC, EntityAttributeOrder NUMERIC, EntityAttributeFormat VARCHAR(32), FilteringEnabled BIT, EventName VARCHAR(200), IndexedEntityAttribute NVARCHAR(4000))
		DECLARE @FinalAuditData TABLE (EventId NUMERIC, EventDateTime DATETIME, Actor VARCHAR(200), EventName VARCHAR(200), EventAction VARCHAR(6), EntityType VARCHAR(100), EntityValue VARCHAR(200), EntityAttribute NVARCHAR(4000), IndexedEntityAttribute NVARCHAR(4000), EntityAttributeValue NVARCHAR(max), EntityAttributeType TINYINT, IndexedEntityAttributeOrder NVARCHAR(4000), EntityItemNumber INT, PreviousEventId NUMERIC, PreviousEntityAttributeValue NVARCHAR(max))
		DECLARE @PreviousAudits TABLE (EventId NUMERIC, EventDateTime DATETIME, Actor VARCHAR(200), EventName VARCHAR(200), EventAction VARCHAR(6), EntityType VARCHAR(100), EntityValue VARCHAR(200), PreviousEventId NUMERIC, PreviousEventValue NVARCHAR(max))
		DECLARE @EntityAttributes TABLE (EventId NUMERIC, EventDateTime DATETIME, Actor VARCHAR(200), EventName VARCHAR(200), EventAction VARCHAR(6), EntityType VARCHAR(100), EntityValue VARCHAR(200), EntityAttribute NVARCHAR(4000), IndexedEntityAttribute NVARCHAR(4000), EntityAttributeValue NVARCHAR(max), EntityAttributeType TINYINT, IndexedEntityAttributeOrder NVARCHAR(4000), EntityItemNumber INT)
		DECLARE @PreviousEntityAttributes TABLE (EventId NUMERIC, PreviousEventId NUMERIC, EventDateTime DATETIME, Actor VARCHAR(200), EventName VARCHAR(200), EventAction VARCHAR(6), EntityType VARCHAR(100), EntityValue VARCHAR(200), EntityAttribute NVARCHAR(4000), IndexedEntityAttribute NVARCHAR(4000), EntityAttributeValue NVARCHAR(max), EntityAttributeType TINYINT, IndexedEntityAttributeOrder NVARCHAR(4000), EntityItemNumber INT)
		DECLARE @EntityAttributeChanges TABLE (EventId NUMERIC, AttributeChanges NUMERIC)
		
		INSERT INTO @Audits
		SELECT EventId, EventDateTime, Actor, EventName, IIF(EventAction = 'INSERT', 'ADD', IIF(EventAction = 'DELETE', 'REMOVE', 'UPDATE')) EventAction, EntityType, EntityValue, JSON_QUERY(EventValue, '$.eventValue') EventValue
		FROM CosysAudit
		WHERE 
			1 = 1 AND
			
            EventName = 'ACES_CUSTOMS'
           
                    AND EntityType = 'AWB' 
                    and EntityValue =?
               
		
		INSERT INTO @PreviousAudits
		SELECT EventId, EventDateTime, Actor, EventName, EventAction, EntityType, EntityValue, LAG(EventId, 1, NULL) OVER (
				PARTITION BY EntityType, EntityValue ORDER BY EventId
				) PreviousEventId, LAG(EventValue, 1, NULL) OVER (
				PARTITION BY EntityType, EntityValue ORDER BY EventId
				) PreviousEventValue
		FROM @Audits;
		
		WITH EntityAttributes
		AS (
			SELECT EventId, EventDateTime, Actor, EventName, EventAction, EntityType, EntityValue, CONCAT ('$.', EventValue.[Key]) EntityAttribute, CONCAT ('$.', EventValue.[Key]) IndexedEntityAttribute, EventValue.[Value] EntityAttributeValue, EventValue.[Type] EntityAttributeType, CONCAT ('', CASE WHEN EventValue.[Type] = 5 OR EventValue.[Type] = 4 THEN '#' + EventValue.[Key] + '#' ELSE '#' END) IndexedEntityAttributeOrder, - 1 EntityItemNumber
			FROM @Audits
			CROSS APPLY OPENJSON(EventValue) EventValue
			
			UNION ALL
			
			SELECT EventId, EventDateTime, Actor, EventName, EventAction, EntityType, EntityValue, CONCAT (EntityAttributes.EntityAttribute, '#') EntityAttribute, CONCAT (EntityAttributes.IndexedEntityAttribute, '[', EventValue.[Key], ']') IndexedEntityAttribute, EventValue.[Value] EntityAttributeValue, EventValue.[Type] EntityAttributeType, CONCAT (IndexedEntityAttributeOrder, CASE WHEN EventValue.[Type] = 5 OR EventValue.[Type] = 4 THEN '#' + EventValue.[Key] + '#' ELSE '#' END) IndexedEntityAttributeOrder, EventValue.[Key] EntityItemNumber
			FROM EntityAttributes
			CROSS APPLY OPENJSON(EntityAttributeValue) EventValue
			WHERE EntityAttributes.EntityAttributeType = 4
			
			UNION ALL
			
			SELECT EventId, EventDateTime, Actor, EventName, EventAction, EntityType, EntityValue, CONCAT (EntityAttributes.EntityAttribute, '.', EventValue.[Key]) EntityAttribute, CONCAT (EntityAttributes.IndexedEntityAttribute, '.', EventValue.[Key]) IndexedEntityAttribute, EventValue.[Value] EntityAttributeValue, EventValue.[Type] EntityAttributeType, CONCAT (IndexedEntityAttributeOrder, CASE WHEN EventValue.[Type] = 5 OR EventValue.[Type] = 4 THEN '#' + EventValue.[Key] + '#' ELSE '#' END) IndexedEntityAttributeOrder, EntityItemNumber
			FROM EntityAttributes
			CROSS APPLY OPENJSON(EntityAttributeValue) EventValue
			WHERE EntityAttributes.EntityAttributeType = 5
			)
		INSERT INTO @EntityAttributes
		SELECT *
		FROM EntityAttributes;
		
		WITH PreviousEntityAttributes
		AS (
			SELECT EventId, PreviousEventId, EventDateTime, Actor, EventName, EventAction, EntityType, EntityValue, CONCAT ('$.', EventValue.[Key]) EntityAttribute, CONCAT ('$.', EventValue.[Key]) IndexedEntityAttribute, EventValue.[Value] EntityAttributeValue, EventValue.[Type] EntityAttributeType, CONCAT ('', CASE WHEN EventValue.[Type] = 5 OR EventValue.[Type] = 4 THEN '#' + EventValue.[Key] + '#' ELSE '#' END) IndexedEntityAttributeOrder, - 1 EntityItemNumber
			FROM @PreviousAudits
			CROSS APPLY OPENJSON(PreviousEventValue) EventValue
			
			UNION ALL
			
			SELECT EventId, PreviousEventId, EventDateTime, Actor, EventName, EventAction, EntityType, EntityValue, CONCAT (PreviousEntityAttributes.EntityAttribute, '#') EntityAttribute, CONCAT (PreviousEntityAttributes.IndexedEntityAttribute, '[', EventValue.[Key], ']') IndexedEntityAttribute, EventValue.[Value] EntityAttributeValue, EventValue.[Type] EntityAttributeType, CONCAT (IndexedEntityAttributeOrder, CASE WHEN EventValue.[Type] = 5 OR EventValue.[Type] = 4 THEN '#' + EventValue.[Key] + '#' ELSE '#' END) IndexedEntityAttributeOrder, EventValue.[Key] EntityItemNumber
			FROM PreviousEntityAttributes
			CROSS APPLY OPENJSON(EntityAttributeValue) EventValue
			WHERE PreviousEntityAttributes.EntityAttributeType = 4
			
			UNION ALL
			
			SELECT EventId, PreviousEventId, EventDateTime, Actor, EventName, EventAction, EntityType, EntityValue, CONCAT (PreviousEntityAttributes.EntityAttribute, '.', EventValue.[Key]) EntityAttribute, CONCAT (PreviousEntityAttributes.IndexedEntityAttribute, '.', EventValue.[Key]) IndexedEntityAttribute, EventValue.[Value] EntityAttributeValue, EventValue.[Type] EntityAttributeType, CONCAT (IndexedEntityAttributeOrder, CASE WHEN EventValue.[Type] = 5 OR EventValue.[Type] = 4 THEN '#' + EventValue.[Key] + '#' ELSE '#' END) IndexedEntityAttributeOrder, EntityItemNumber
			FROM PreviousEntityAttributes
			CROSS APPLY OPENJSON(EntityAttributeValue) EventValue
			WHERE PreviousEntityAttributes.EntityAttributeType = 5
			)
		INSERT INTO @PreviousEntityAttributes
		SELECT *
		FROM PreviousEntityAttributes
		
		INSERT INTO @FinalEntityAttributes
		SELECT CosysAuditEntityAttributes.*, EntityAttributes.EventName, EntityAttributes.IndexedEntityAttribute
		FROM (
			SELECT EntityType, EventName, EntityAttribute COLLATE DATABASE_DEFAULT EntityAttribute, IndexedEntityAttribute
			FROM @EntityAttributes
			GROUP BY EntityType, EventName, EntityAttribute, IndexedEntityAttribute
			) EntityAttributes, CosysAuditEntityAttributes
		WHERE EntityAttributes.EntityType = CosysAuditEntityAttributes.EntityType AND EntityAttributes.EntityAttribute = CosysAuditEntityAttributes.EntityAttribute
		
		INSERT INTO @FinalAuditData
		SELECT EntityAttributes.*, PreviousEntityAttributes.PreviousEventId, PreviousEntityAttributes.EntityAttributeValue PreviousEntityAttributeValue
		FROM @EntityAttributes EntityAttributes
		LEFT JOIN @PreviousEntityAttributes PreviousEntityAttributes ON EntityAttributes.EventId = PreviousEntityAttributes.EventId AND EntityAttributes.EntityType = PreviousEntityAttributes.EntityType AND EntityAttributes.EntityAttribute = PreviousEntityAttributes.EntityAttribute AND EntityAttributes.IndexedEntityAttribute = PreviousEntityAttributes.IndexedEntityAttribute
				
		INSERT INTO @IndexedEntityAttributes
		SELECT DISTINCT IndexedEntityAttributes.EntityAttribute, FinalEntityAttributes.EntityAttributeName
		FROM @FinalEntityAttributes AS FinalEntityAttributes
		CROSS APPLY (
			SELECT LEFT(IndexedEntityAttributes.EntityAttribute, LEN(IndexedEntityAttributes.EntityAttribute) - CHARINDEX('#', SUBSTRING(REVERSE(IndexedEntityAttributes.EntityAttribute), 1, 1))) IndexedEntityAttributeName, IndexedEntityAttributes.EntityAttribute
			FROM @FinalEntityAttributes IndexedEntityAttributes
			WHERE IndexedEntityAttributes.EntityAttributeType = 5 AND LEFT(IndexedEntityAttributes.EntityAttribute, LEN(IndexedEntityAttributes.EntityAttribute) - CHARINDEX('#', SUBSTRING(REVERSE(IndexedEntityAttributes.EntityAttribute), 1, 1))) = FinalEntityAttributes.EntityAttribute
			) IndexedEntityAttributes
		WHERE FinalEntityAttributes.EntityAttributeType = 4
		
		INSERT INTO @EntityAttributeChanges
		SELECT FinalAuditData.EventId, COUNT(1) AttributeChanges
		FROM @FinalAuditData FinalAuditData
		JOIN @FinalEntityAttributes FinalEntityAttributes ON FinalAuditData.EntityType = FinalEntityAttributes.EntityType AND FinalAuditData.EventName = FinalEntityAttributes.EventName AND FinalAuditData.EntityAttribute COLLATE DATABASE_DEFAULT = FinalEntityAttributes.EntityAttribute AND FinalAuditData.IndexedEntityAttribute = FinalEntityAttributes.IndexedEntityAttribute
		WHERE FinalAuditData.EntityAttributeValue != FinalAuditData.PreviousEntityAttributeValue
		GROUP BY FinalAuditData.EventId
		
		SELECT
		    FinalAuditData.EventId, FinalAuditData.EventDateTime, FinalAuditData.Actor, COALESCE(CosysAuditEntityEvents.EventName, FinalAuditData.EventName) EventName, FinalAuditData.EventAction, FinalAuditData.EntityType, FinalAuditData.EntityValue,
		    REPLACE(STRING_AGG(
		        CASE
		            WHEN FinalAuditData.PreviousEventId IS NOT NULL AND ISNULL(EntityAttributeChanges.AttributeChanges, 0) != 0 AND FinalAuditData.EventAction = 'UPDATE' AND FinalAuditData.EntityAttributeValue != FinalAuditData.PreviousEntityAttributeValue THEN
		                CONCAT(IIF(FinalEntityAttributes.EntityAttributeType = 5, CONCAT('', IndexedEntityAttributes.EntityAttributeName, ' '),''), FORMATMESSAGE(FinalEntityAttributes.EntityAttributeName, CONVERT(NVARCHAR, FinalAuditData.EntityItemNumber + 1)), ': ',
		                    CASE
		                        WHEN FinalAuditData.EntityAttributeValue IS NULL OR FinalAuditData.EntityAttributeType = 4 OR FinalAuditData.EntityAttributeType = 5 THEN ''
		                        WHEN FinalEntityAttributes.EntityAttributeType = 3 THEN IIF(TRY_CONVERT(BIT, FinalAuditData.EntityAttributeValue) = 1, 'Y', 'N')
		                        WHEN FinalEntityAttributes.EntityAttributeType = 9 THEN UPPER(FORMAT(TRY_CONVERT(DATETIME2, FinalAuditData.EntityAttributeValue), FinalEntityAttributes.EntityAttributeFormat))
		                        WHEN FinalEntityAttributes.EntityAttributeType = 8 THEN UPPER(FORMAT(TRY_CONVERT(NUMERIC, FinalAuditData.EntityAttributeValue), 'C', FinalEntityAttributes.EntityAttributeFormat))
		                        ELSE FinalAuditData.EntityAttributeValue
		                    END,
		                    CASE
		                        WHEN FinalAuditData.EntityAttributeType = 4 OR FinalAuditData.EntityAttributeType = 5 OR FinalAuditData.PreviousEntityAttributeValue IS NULL OR FinalAuditData.EntityAttributeValue = FinalAuditData.PreviousEntityAttributeValue THEN ''
		                        WHEN FinalEntityAttributes.EntityAttributeType = 3 THEN CONCAT('{', IIF(TRY_CONVERT(BIT, FinalAuditData.PreviousEntityAttributeValue) = 1, 'Y', 'N'), '}')
		                        WHEN FinalEntityAttributes.EntityAttributeType = 9 THEN CONCAT('{', ISNULL(UPPER(FORMAT(TRY_CONVERT(DATETIME2, FinalAuditData.PreviousEntityAttributeValue), FinalEntityAttributes.EntityAttributeFormat)), ''), '}')
		                        WHEN FinalEntityAttributes.EntityAttributeType = 8 THEN CONCAT('{', ISNULL(UPPER(FORMAT(TRY_CONVERT(NUMERIC, FinalAuditData.PreviousEntityAttributeValue), 'C', FinalEntityAttributes.EntityAttributeFormat)), ''), '}')
		                        ELSE CONCAT('{', ISNULL(FinalAuditData.PreviousEntityAttributeValue, ''), '}')
		                    END
		                )
		            WHEN FinalAuditData.PreviousEventId IS NULL OR ISNULL(EntityAttributeChanges.AttributeChanges, 0) = 0 OR FinalAuditData.EventAction != 'UPDATE' THEN
		                CONCAT(IIF(FinalEntityAttributes.EntityAttributeType = 5, CONCAT('', IndexedEntityAttributes.EntityAttributeName, ' '),''), FORMATMESSAGE(FinalEntityAttributes.EntityAttributeName, CONVERT(NVARCHAR, FinalAuditData.EntityItemNumber + 1)), ': ',
		                    CASE
		                        WHEN FinalAuditData.EntityAttributeValue IS NULL OR FinalAuditData.EntityAttributeType = 4 OR FinalAuditData.EntityAttributeType = 5 THEN ''
		                        WHEN FinalEntityAttributes.EntityAttributeType = 3 THEN IIF(TRY_CONVERT(BIT, FinalAuditData.EntityAttributeValue) = 1, 'Y', 'N')
		                        WHEN FinalEntityAttributes.EntityAttributeType = 9 THEN UPPER(FORMAT(TRY_CONVERT(DATETIME2, FinalAuditData.EntityAttributeValue), FinalEntityAttributes.EntityAttributeFormat))
		                        WHEN FinalEntityAttributes.EntityAttributeType = 8 THEN UPPER(FORMAT(TRY_CONVERT(NUMERIC, FinalAuditData.EntityAttributeValue), 'C', FinalEntityAttributes.EntityAttributeFormat))
		                        ELSE FinalAuditData.EntityAttributeValue
		                    END
		                )
		        END
		    , ', ') WITHIN GROUP (ORDER BY FinalAuditData.IndexedEntityAttributeOrder, FinalEntityAttributes.EntityAttributeOrder), ': , ', ': , ') EventValue
		FROM @FinalAuditData FinalAuditData
		JOIN @FinalEntityAttributes FinalEntityAttributes ON FinalAuditData.EntityType = FinalEntityAttributes.EntityType AND FinalAuditData.EventName = FinalEntityAttributes.EventName AND FinalAuditData.EntityAttribute COLLATE DATABASE_DEFAULT = FinalEntityAttributes.EntityAttribute AND FinalAuditData.IndexedEntityAttribute = FinalEntityAttributes.IndexedEntityAttribute
		LEFT JOIN @EntityAttributeChanges EntityAttributeChanges ON FinalAuditData.EventId = EntityAttributeChanges.EventId
		LEFT JOIN CosysAuditEntityEvents ON FinalAuditData.EntityType = CosysAuditEntityEvents.EntityType AND CosysAuditEntityEvents.EventType = FinalAuditData.EventName
		LEFT JOIN @IndexedEntityAttributes IndexedEntityAttributes ON FinalEntityAttributes.EntityAttribute = IndexedEntityAttributes.EntityAttribute
		
		GROUP BY FinalAuditData.EventId, FinalAuditData.EventDateTime, FinalAuditData.Actor, COALESCE(CosysAuditEntityEvents.EventName, FinalAuditData.EventName), FinalAuditData.EventAction, FinalAuditData.EntityType, FinalAuditData.EntityValue
		ORDER BY FinalAuditData.EventDateTime



]]></xml-property>
        </oda-data-set>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="SingaporeDateTime" id="4201">
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">currentDateTime</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">currentDateTime</text-property>
                    <text-property name="heading">currentDateTime</text-property>
                </structure>
            </list-property>
            <list-property name="parameters"/>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">currentDateTime</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">currentDateTime</property>
                    <property name="nativeName">currentDateTime</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[select UPPER(convert(datetime, CONVERT(datetimeoffset, getDate()) AT TIME ZONE (select ParameterValueChar from App_SystemParameters where ParameterCode='Station_timezone'))) currentDateTime ]]></xml-property>
            <xml-property name="designerValues"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<model:DesignValues xmlns:design="http://www.eclipse.org/datatools/connectivity/oda/design" xmlns:model="http://www.eclipse.org/birt/report/model/adapter/odaModel">
  <Version>2.0</Version>
  <design:ResultSets derivedMetaData="true">
    <design:resultSetDefinitions>
      <design:resultSetColumns>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>currentDateTime</design:name>
              <design:position>1</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>4000</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>currentDateTime</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>currentDateTime</design:label>
            <design:formattingHints>
              <design:displaySize>4000</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
      </design:resultSetColumns>
      <design:criteria/>
    </design:resultSetDefinitions>
  </design:ResultSets>
</model:DesignValues>]]></xml-property>
        </oda-data-set>
    </data-sets>
    <page-setup>
        <simple-master-page name="Simple MasterPage" id="2">
            <page-footer>
                <data id="4209">
                    <property name="textAlign">right</property>
                    <list-property name="boundDataColumns">
                        <structure>
                            <property name="name">tenantCurrentDateTime</property>
                            <expression name="expression" type="javascript">params["tenantCurrentDateTime"]</expression>
                            <property name="dataType">string</property>
                            <property name="allowExport">true</property>
                        </structure>
                    </list-property>
                    <property name="resultSetColumn">tenantCurrentDateTime</property>
                </data>
            </page-footer>
        </simple-master-page>
    </page-setup>
    <body>
        <label id="4">
            <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
            <property name="fontFamily">"Courier New"</property>
            <property name="fontSize">12pt</property>
            <property name="textAlign">center</property>
            <text-property name="text">custom.sm.history</text-property>
        </label>
        <grid id="5">
            <column id="6"/>
            <column id="7"/>
            <column id="8"/>
            <column id="9"/>
            <column id="10"/>
            <column id="11"/>
            <column id="12"/>
            <column id="13"/>
            <row id="14">
                <property name="fontFamily">"Courier New"</property>
                <property name="fontSize">12pt</property>
                <cell id="15">
                    <property name="colSpan">2</property>
                    <property name="rowSpan">1</property>
                    <label id="23">
                        <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                        <property name="fontFamily">"Courier New"</property>
                        <property name="fontSize">12pt</property>
                        <text-property name="text">custom.awb</text-property>
                    </label>
                </cell>
                <cell id="17">
                    <property name="colSpan">2</property>
                    <property name="rowSpan">1</property>
                    <data id="4207">
                        <list-property name="boundDataColumns">
                            <structure>
                                <property name="name">awb</property>
                                <expression name="expression" type="javascript">params["awb"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                        </list-property>
                        <property name="resultSetColumn">awb</property>
                    </data>
                </cell>
                <cell id="19"/>
                <cell id="20"/>
                <cell id="21"/>
                <cell id="22"/>
            </row>
        </grid>
        <grid id="382">
            <property name="fontFamily">"Courier New"</property>
            <column id="383">
                <property name="width">0.8in</property>
            </column>
            <column id="384">
                <property name="width">1.4in</property>
            </column>
            <column id="385"/>
            <column id="386">
                <property name="width">0.9in</property>
            </column>
            <column id="387"/>
            <column id="388"/>
            <column id="389"/>
            <column id="390"/>
            <row id="391">
                <property name="fontFamily">"Courier New"</property>
                <property name="fontSize">12pt</property>
                <cell id="392">
                    <label id="409">
                        <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                        <text-property name="text">g.date.caps</text-property>
                    </label>
                </cell>
                <cell id="393">
                    <label id="410">
                        <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                        <property name="textAlign">center</property>
                        <text-property name="text">g.time.caps</text-property>
                    </label>
                </cell>
                <cell id="394"/>
                <cell id="395"/>
                <cell id="396"/>
                <cell id="397"/>
                <cell id="398"/>
                <cell id="399"/>
            </row>
            <row id="400">
                <property name="fontSize">12pt</property>
                <cell id="401">
                    <label id="4205">
                        <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                        <property name="textAlign">center</property>
                        <text-property name="text">custom.sno</text-property>
                    </label>
                </cell>
                <cell id="402">
                    <label id="412">
                        <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                        <property name="textAlign">center</property>
                        <text-property name="text">custom.action</text-property>
                    </label>
                </cell>
                <cell id="403"/>
                <cell id="404"/>
                <cell id="405">
                    <property name="colSpan">2</property>
                    <property name="rowSpan">1</property>
                    <label id="413">
                        <property name="eventHandlerClass">com.ngen.cosys.report.event.LabelEventHandler</property>
                        <property name="textAlign">left</property>
                        <text-property name="text">report.details</text-property>
                    </label>
                </cell>
                <cell id="407"/>
                <cell id="408"/>
            </row>
            <row id="414">
                <property name="fontSize">12pt</property>
                <property name="height">0.3in</property>
                <cell id="415"/>
                <cell id="416"/>
                <cell id="417"/>
                <cell id="418"/>
                <cell id="419"/>
                <cell id="420"/>
                <cell id="421"/>
                <cell id="422"/>
            </row>
        </grid>
        <table id="281">
            <property name="fontFamily">"Courier New"</property>
            <property name="fontSize">12pt</property>
            <property name="dataSet">Data Set1</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">EventId</property>
                    <text-property name="displayName">EventId</text-property>
                    <expression name="expression" type="javascript">dataSetRow["EventId"]</expression>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="name">EventDateTime</property>
                    <text-property name="displayName">EventDateTime</text-property>
                    <expression name="expression" type="javascript">Formatter.format(dataSetRow["EventDateTime"],'ddMMMyyyy HHmm')</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">Actor</property>
                    <text-property name="displayName">Actor</text-property>
                    <expression name="expression" type="javascript">dataSetRow["Actor"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">EventName</property>
                    <text-property name="displayName">EventName</text-property>
                    <expression name="expression" type="javascript">dataSetRow["EventName"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">EventAction</property>
                    <text-property name="displayName">EventAction</text-property>
                    <expression name="expression" type="javascript">dataSetRow["EventAction"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">EntityType</property>
                    <text-property name="displayName">EntityType</text-property>
                    <expression name="expression" type="javascript">dataSetRow["EntityType"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">EntityValue</property>
                    <text-property name="displayName">EntityValue</text-property>
                    <expression name="expression" type="javascript">dataSetRow["EntityValue"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">EventValue</property>
                    <text-property name="displayName">EventValue</text-property>
                    <expression name="expression" type="javascript">dataSetRow["EventValue"].split(',').join('\n')</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">Aggregation</property>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">RUNNINGCOUNT</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
            </list-property>
            <column id="315"/>
            <column id="317"/>
            <column id="318"/>
            <column id="320"/>
            <column id="321"/>
            <column id="322"/>
            <column id="323"/>
            <column id="324"/>
            <group id="357">
                <property name="groupName">NewTableGroup1</property>
                <expression name="keyExpr" type="javascript">row["EventDateTime"]</expression>
                <structure name="toc">
                    <expression name="expressionValue" type="javascript">row["EventDateTime"]</expression>
                </structure>
                <property name="hideDetail">false</property>
                <header>
                    <row id="358">
                        <cell id="359">
                            <property name="colSpan">2</property>
                            <property name="rowSpan">1</property>
                            <data id="380">
                                <property name="resultSetColumn">EventDateTime</property>
                            </data>
                        </cell>
                        <cell id="362"/>
                        <cell id="364"/>
                        <cell id="365"/>
                        <cell id="366"/>
                        <cell id="367"/>
                        <cell id="368"/>
                    </row>
                </header>
                <footer>
                    <row id="369">
                        <cell id="370"/>
                        <cell id="372"/>
                        <cell id="373"/>
                        <cell id="375"/>
                        <cell id="376"/>
                        <cell id="377"/>
                        <cell id="378"/>
                        <cell id="379"/>
                    </row>
                </footer>
            </group>
            <detail>
                <row id="293">
                    <cell id="294">
                        <data id="4204">
                            <property name="resultSetColumn">Aggregation</property>
                        </data>
                    </cell>
                    <cell id="296">
                        <data id="334">
                            <property name="textAlign">center</property>
                            <property name="resultSetColumn">EventAction</property>
                        </data>
                    </cell>
                    <cell id="297"/>
                    <cell id="299">
                        <property name="colSpan">5</property>
                        <property name="rowSpan">1</property>
                        <property name="textAlign">left</property>
                        <data id="326">
                            <property name="fontFamily">"Courier New"</property>
                            <property name="resultSetColumn">EventValue</property>
                        </data>
                    </cell>
                </row>
                <row id="346">
                    <property name="height">0.2in</property>
                    <cell id="347"/>
                    <cell id="349"/>
                    <cell id="350"/>
                    <cell id="352"/>
                    <cell id="353"/>
                    <cell id="354"/>
                    <cell id="355"/>
                    <cell id="356"/>
                </row>
            </detail>
            <footer>
                <row id="304">
                    <cell id="305"/>
                    <cell id="307"/>
                    <cell id="308"/>
                    <cell id="310"/>
                    <cell id="311"/>
                    <cell id="312"/>
                    <cell id="313"/>
                    <cell id="314"/>
                </row>
            </footer>
        </table>
    </body>
</report>
