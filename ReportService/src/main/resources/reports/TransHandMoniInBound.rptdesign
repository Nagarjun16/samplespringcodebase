<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.23" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 4.6.0.v201606072122</property>
    <property name="units">in</property>
    <property name="iconFile">/templates/blank_report.gif</property>
    <property name="bidiLayoutOrientation">ltr</property>
    <property name="imageDPI">96</property>
    <parameters>
        <scalar-parameter name="tenantId" id="267">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="shcByPurpose" id="268">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="fromDateTime" id="269">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="toDateTime" id="270">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="carrierCode" id="271">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="carrierGroup" id="272">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <oda-data-source extensionID="org.eclipse.birt.report.data.oda.jdbc" name="Data Source" id="15">
            <list-property name="privateDriverProperties">
                <ex-property>
                    <name>metadataBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledMetadataBidiFormatStr</name>
                </ex-property>
                <ex-property>
                    <name>contentBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledContentBidiFormatStr</name>
                </ex-property>
            </list-property>
            <property name="odaDriverClass">com.microsoft.sqlserver.jdbc.SQLServerDriver</property>
            <property name="odaURL">jdbc:sqlserver://cosysuatsqldb1server.database.windows.net;databaseName=SIN3_QA_Azure</property>
            <property name="odaUser">SATsDevQaUser</property>
            <encrypted-property name="odaPassword" encryptionID="base64">U0B0c3VzZXIjIw==</encrypted-property>
        </oda-data-source>
    </data-sources>
    <data-sets>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="Data Set" id="34">
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">FlightKey</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">FlightKey</text-property>
                    <text-property name="heading">FlightKey</text-property>
                </structure>
                <structure>
                    <property name="columnName">Flight_ID</property>
                    <property name="analysis">measure</property>
                    <text-property name="displayName">Flight_ID</text-property>
                    <text-property name="heading">Flight_ID</text-property>
                </structure>
                <structure>
                    <property name="columnName">airport</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">airport</text-property>
                    <text-property name="heading">airport</text-property>
                </structure>
                <structure>
                    <property name="columnName">standardEstimatedDateTime</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">standardEstimatedDateTime</text-property>
                    <text-property name="heading">standardEstimatedDateTime</text-property>
                </structure>
                <structure>
                    <property name="columnName">CarrierCode</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">CarrierCode</text-property>
                    <text-property name="heading">CarrierCode</text-property>
                </structure>
                <structure>
                    <property name="columnName">isFinalized</property>
                    <property name="analysis">measure</property>
                    <text-property name="displayName">isFinalized</text-property>
                    <text-property name="heading">isFinalized</text-property>
                </structure>
                <structure>
                    <property name="columnName">tenantId</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">tenantId</text-property>
                    <text-property name="heading">tenantId</text-property>
                </structure>
                <structure>
                    <property name="columnName">dateAndAirport</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">dateAndAirport</text-property>
                    <text-property name="heading">dateAndAirport</text-property>
                </structure>
                <structure>
                    <property name="columnName">stdTime</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">stdTime</text-property>
                    <text-property name="heading">stdTime</text-property>
                </structure>
            </list-property>
            <list-property name="parameters">
                <structure>
                    <property name="name">param_1</property>
                    <property name="paramName">tenantId</property>
                    <property name="dataType">string</property>
                    <property name="position">1</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_2</property>
                    <property name="paramName">shcByPurpose</property>
                    <property name="dataType">string</property>
                    <property name="position">2</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_3</property>
                    <property name="paramName">shcByPurpose</property>
                    <property name="dataType">string</property>
                    <property name="position">3</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_4</property>
                    <property name="paramName">shcByPurpose</property>
                    <property name="dataType">string</property>
                    <property name="position">4</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_5</property>
                    <property name="paramName">shcByPurpose</property>
                    <property name="dataType">string</property>
                    <property name="position">5</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_6</property>
                    <property name="paramName">shcByPurpose</property>
                    <property name="dataType">string</property>
                    <property name="position">6</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_7</property>
                    <property name="paramName">shcByPurpose</property>
                    <property name="dataType">string</property>
                    <property name="position">7</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_8</property>
                    <property name="paramName">shcByPurpose</property>
                    <property name="dataType">string</property>
                    <property name="position">8</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_9</property>
                    <property name="paramName">shcByPurpose</property>
                    <property name="dataType">string</property>
                    <property name="position">9</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_10</property>
                    <property name="paramName">shcByPurpose</property>
                    <property name="dataType">string</property>
                    <property name="position">10</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_11</property>
                    <property name="paramName">shcByPurpose</property>
                    <property name="dataType">string</property>
                    <property name="position">11</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_12</property>
                    <property name="paramName">tenantId</property>
                    <property name="dataType">string</property>
                    <property name="position">12</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_13</property>
                    <property name="paramName">fromDateTime</property>
                    <property name="dataType">string</property>
                    <property name="position">13</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_14</property>
                    <property name="paramName">toDateTime</property>
                    <property name="dataType">string</property>
                    <property name="position">14</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_15</property>
                    <property name="paramName">carrierCode</property>
                    <property name="dataType">string</property>
                    <property name="position">15</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_16</property>
                    <property name="paramName">carrierCode</property>
                    <property name="dataType">string</property>
                    <property name="position">16</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_17</property>
                    <property name="paramName">carrierGroup</property>
                    <property name="dataType">string</property>
                    <property name="position">17</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_18</property>
                    <property name="paramName">carrierGroup</property>
                    <property name="dataType">string</property>
                    <property name="position">18</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">FlightKey</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">Flight_ID</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">airport</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">standardEstimatedDateTime</property>
                        <property name="dataType">date-time</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">CarrierCode</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">isFinalized</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">tenantId</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">dateAndAirport</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">stdTime</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">FlightKey</property>
                    <property name="nativeName">FlightKey</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">Flight_ID</property>
                    <property name="nativeName">Flight_ID</property>
                    <property name="dataType">decimal</property>
                    <property name="nativeDataType">2</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">airport</property>
                    <property name="nativeName">airport</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">standardEstimatedDateTime</property>
                    <property name="nativeName">standardEstimatedDateTime</property>
                    <property name="dataType">date-time</property>
                    <property name="nativeDataType">93</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">CarrierCode</property>
                    <property name="nativeName">CarrierCode</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">isFinalized</property>
                    <property name="nativeName">isFinalized</property>
                    <property name="dataType">integer</property>
                    <property name="nativeDataType">4</property>
                </structure>
                <structure>
                    <property name="position">7</property>
                    <property name="name">tenantId</property>
                    <property name="nativeName">tenantId</property>
                    <property name="dataType">integer</property>
                    <property name="nativeDataType">4</property>
                </structure>
                <structure>
                    <property name="position">8</property>
                    <property name="name">dateAndAirport</property>
                    <property name="nativeName">dateAndAirport</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">9</property>
                    <property name="name">stdTime</property>
                    <property name="nativeName">stdTime</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[select 
distinct 
	Flt_OperativeFlight.FlightKey,
	Flt_OperativeFlight.Flight_ID,
	Flt_OperativeFlight_Legs.FlightBoardPoint airport,
	isNull(Flt_OperativeFlight_Legs.DateETA, Flt_OperativeFlight_Legs.DateSTA) standardEstimatedDateTime,
	Flt_OperativeFlight.CarrierCode,
	case when(Imp_FlightEvents.ThroughTransitWorkingListFinalizedAt is null) then 0 else 1 end isFinalized,
	? tenantId,
	concat(CAST(UPPER(FORMAT(isNull(Flt_OperativeFlight_Legs.DateETA, Flt_OperativeFlight_Legs.DateSTA) , 'ddMMMyyy', 'en-US')) as varchar),
		' - ', Flt_OperativeFlight_Legs.FlightBoardPoint) dateAndAirport,
	CAST(UPPER(FORMAT(isNull(Flt_OperativeFlight_Legs.DateETA, Flt_OperativeFlight_Legs.DateSTA) , 'HH:mm', 'en-US')) as varchar) stdTime
from 
	Flt_OperativeFlight inner join 
	Flt_OperativeFlight_Legs 
		on Flt_OperativeFlight_Legs.Flight_ID = Flt_OperativeFlight.Flight_ID left join
	Imp_FlightEvents
		on Flt_OperativeFlight.Flight_ID = Imp_FlightEvents.FlightId
where 
	Flt_OperativeFlight.Flight_ID in (
		select 
			distinct 
				Transhipment_TTWAConnectingFlight.InboundFlightId
			from 
				Transhipment_TTWAOutboundFlight inner join
				Transhipment_TTWAConnectingFlight
					on Transhipment_TTWAOutboundFlight.TransTTWAOutboundFlightId = Transhipment_TTWAConnectingFlight.TransTTWAOutboundFlightId inner join
				Imp_ArrivalManifestByFlight
					on Transhipment_TTWAConnectingFlight.InboundFlightId = Imp_ArrivalManifestByFlight.FlightId inner join
				Imp_ArrivalManifestBySegment
					on Imp_ArrivalManifestByFlight.ImpArrivalManifestByFlightId = Imp_ArrivalManifestBySegment.ImpArrivalManifestByFlightId inner join
				Imp_ArrivalManifestULD
					on Imp_ArrivalManifestBySegment.ImpArrivalManifestBySegmentId = Imp_ArrivalManifestULD.ImpArrivalManifestBySegmentId inner join
				Imp_ArrivalManifestShipmentInfo
					on Imp_ArrivalManifestULD.ImpArrivalManifestULDId = Imp_ArrivalManifestShipmentInfo.ImpArrivalManifestULDId
			where
				Imp_ArrivalManifestShipmentInfo.TransferType is not null
				--<if test="shcByPurpose != null and shcByPurpose != null">
				and (? is null  OR exists (
					select
						1
					from
						Imp_ArrivalManifestByShipmentSHC inner join
						Mst_AssociateSHCByHandlingGroup
							on Imp_ArrivalManifestByShipmentSHC.SpecialHandlingCode = Mst_AssociateSHCByHandlingGroup.SpecialHandlingCode inner join
						Mst_SHCHandlingGroup
							on Mst_AssociateSHCByHandlingGroup.MstSHCHandlingGroupID = Mst_SHCHandlingGroup.MstSHCHandlingGroupID
					where
						Imp_ArrivalManifestByShipmentSHC.ImpArrivalManifestShipmentInfoId = Imp_ArrivalManifestShipmentInfo.ImpArrivalManifestShipmentInfoId and
						Mst_SHCHandlingGroup.SHCHandlingGroupCode = ?
					))
				--<if test="shcByPurpose != null and shcByPurpose != null">
					and (? is null  OR exists(
					select
						1
					from
						Imp_ArrivalManifestByShipmentSHC inner join
						Mst_AssociateSHCByHandlingGroup
							on Imp_ArrivalManifestByShipmentSHC.SpecialHandlingCode = Mst_AssociateSHCByHandlingGroup.SpecialHandlingCode inner join
						Mst_SHCHandlingGroup
							on Mst_AssociateSHCByHandlingGroup.MstSHCHandlingGroupID = Mst_SHCHandlingGroup.MstSHCHandlingGroupID
					where
						Imp_ArrivalManifestByShipmentSHC.ImpArrivalManifestShipmentInfoId = Imp_ArrivalManifestShipmentInfo.ImpArrivalManifestShipmentInfoId and
						Mst_SHCHandlingGroup.SHCHandlingGroupCode = ?
					))
			union
		select 
			distinct 
				Imp_ArrivalManifestByFlight.FlightId 
			from 
				Imp_ArrivalManifestByFlight inner join
				Imp_ArrivalManifestBySegment
					on Imp_ArrivalManifestByFlight.ImpArrivalManifestByFlightId = Imp_ArrivalManifestBySegment.ImpArrivalManifestByFlightId inner join 
				Imp_ArrivalManifestULD
					on Imp_ArrivalManifestBySegment.ImpArrivalManifestBySegmentId = Imp_ArrivalManifestULD.ImpArrivalManifestBySegmentId inner join
				Imp_ArrivalManifestShipmentInfo
					on Imp_ArrivalManifestULD.ImpArrivalManifestULDId = Imp_ArrivalManifestShipmentInfo.ImpArrivalManifestULDId inner join 
				Exp_ShipmentBooking
					on Imp_ArrivalManifestShipmentInfo.ShipmentNumber = Exp_ShipmentBooking.ShipmentNumber and 
						Imp_ArrivalManifestShipmentInfo.ShipmentDate = Exp_ShipmentBooking.ShipmentDate inner join 
				Exp_ShipmentFlightBookingDetail
					on Exp_ShipmentBooking.BookingId = Exp_ShipmentFlightBookingDetail.BookingId and 
						Imp_ArrivalManifestByFlight.FlightId = Exp_ShipmentFlightBookingDetail.FlightId and
							Exp_ShipmentFlightBookingDetail.OutwardBookingFlag = 0
				where 1=1  -- dont remove
			--<if test="shcByPurpose != null and shcByPurpose != null">
				and (? is null  OR exists(
					select
						1
					from
						Imp_ArrivalManifestByShipmentSHC inner join
						Mst_AssociateSHCByHandlingGroup
							on Imp_ArrivalManifestByShipmentSHC.SpecialHandlingCode = Mst_AssociateSHCByHandlingGroup.SpecialHandlingCode inner join
						Mst_SHCHandlingGroup
							on Mst_AssociateSHCByHandlingGroup.MstSHCHandlingGroupID = Mst_SHCHandlingGroup.MstSHCHandlingGroupID
					where
						Imp_ArrivalManifestByShipmentSHC.ImpArrivalManifestShipmentInfoId = Imp_ArrivalManifestShipmentInfo.ImpArrivalManifestShipmentInfoId and
						Mst_SHCHandlingGroup.SHCHandlingGroupCode = ?
				))
			union
		select 
			distinct 
				incomingBooking.FlightId 
			from 
				Exp_ShipmentBooking inner join
				Exp_ShipmentFlightBookingDetail outgoingBooking
					on Exp_ShipmentBooking.BookingId = outgoingBooking.BookingId and
						outgoingBooking.OutwardBookingFlag = 1 inner join 
				Exp_ShipmentFlightBookingDetail incomingBooking
					on Exp_ShipmentBooking.BookingId = incomingBooking.BookingId 
			where
				outgoingBooking.ThroughTransitFlag = 1 
				--<if test="shcByPurpose != null and shcByPurpose != null">
				and (? is null  OR exists(
					select
						1
					from
						Exp_ShipmentFlightBookingDetailSHC inner join
						Mst_AssociateSHCByHandlingGroup
							on Exp_ShipmentFlightBookingDetailSHC.SpecialHandlingCode = Mst_AssociateSHCByHandlingGroup.SpecialHandlingCode inner join
						Mst_SHCHandlingGroup
							on Mst_AssociateSHCByHandlingGroup.MstSHCHandlingGroupID = Mst_SHCHandlingGroup.MstSHCHandlingGroupID
					where
						Exp_ShipmentFlightBookingDetailSHC.FlightBookingId = outgoingBooking.FlightBookingId and
						Mst_SHCHandlingGroup.SHCHandlingGroupCode = ?
					))
		union
		select 
			distinct 
				incomingBooking.FlightId
			from 
				Exp_ShipmentBooking inner join
				Exp_ShipmentFlightBookingDetail outgoingBooking
					on Exp_ShipmentBooking.BookingId = outgoingBooking.BookingId and
						outgoingBooking.OutwardBookingFlag = 1 inner join 
				Exp_ShipmentFlightBookingDetail incomingBooking
					on Exp_ShipmentBooking.BookingId = incomingBooking.BookingId
					and incomingBooking.OutwardBookingFlag < outgoingBooking.OutwardBookingFlag
				--<if test="shcByPurpose != null and shcByPurpose != null">
					and (? is null  OR exists(
					select
						1
					from
						Exp_ShipmentFlightBookingDetailSHC inner join
						Mst_AssociateSHCByHandlingGroup
							on Exp_ShipmentFlightBookingDetailSHC.SpecialHandlingCode = Mst_AssociateSHCByHandlingGroup.SpecialHandlingCode inner join
						Mst_SHCHandlingGroup
							on Mst_AssociateSHCByHandlingGroup.MstSHCHandlingGroupID = Mst_SHCHandlingGroup.MstSHCHandlingGroupID
					where
						Exp_ShipmentFlightBookingDetailSHC.FlightBookingId = outgoingBooking.FlightBookingId and
						Mst_SHCHandlingGroup.SHCHandlingGroupCode = ?
					))
		) and
	Flt_OperativeFlight_Legs.FlightOffPoint = ? and
	isnull(Flt_OperativeFlight_Legs.DateETA, Flt_OperativeFlight_Legs.DateSTA) >= ? and
		isnull(Flt_OperativeFlight_Legs.DateETA, Flt_OperativeFlight_Legs.DateSTA) <= ?
			
	and (isnull(?, '') = '' or Flt_OperativeFlight.CarrierCode = ?)
	--and Flt_OperativeFlight.CarrierCode = #{carrier}

	--<if test="carrierGroup != null and carrierGroup != null">
	and (? is null  OR exists (
		select
			1
		from
			Mst_CarrierGroup inner join
			Mst_AssociateCarrierWithGroup
				on Mst_CarrierGroup.Mst_CarrierGroup_ID = Mst_AssociateCarrierWithGroup.Mst_CarrierGroup_ID
		where
			Mst_AssociateCarrierWithGroup.CarrierCode = Flt_OperativeFlight.CarrierCode
			and Mst_CarrierGroup.CarrierGroupCode = ?
	))
]]></xml-property>
            <xml-property name="designerValues"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<model:DesignValues xmlns:design="http://www.eclipse.org/datatools/connectivity/oda/design" xmlns:model="http://www.eclipse.org/birt/report/model/adapter/odaModel">
  <Version>2.0</Version>
  <design:ResultSets derivedMetaData="true">
    <design:resultSetDefinitions>
      <design:resultSetColumns>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>FlightKey</design:name>
              <design:position>1</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>8</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>FlightKey</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>FlightKey</design:label>
            <design:formattingHints>
              <design:displaySize>8</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>Flight_ID</design:name>
              <design:position>2</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>2</design:nativeDataTypeCode>
            <design:precision>15</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>Flight_ID</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>Flight_ID</design:label>
            <design:formattingHints>
              <design:displaySize>17</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>airport</design:name>
              <design:position>3</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>3</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>airport</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>airport</design:label>
            <design:formattingHints>
              <design:displaySize>3</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>standardEstimatedDateTime</design:name>
              <design:position>4</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>93</design:nativeDataTypeCode>
            <design:precision>23</design:precision>
            <design:scale>3</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>standardEstimatedDateTime</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>standardEstimatedDateTime</design:label>
            <design:formattingHints>
              <design:displaySize>23</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>CarrierCode</design:name>
              <design:position>5</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>3</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>CarrierCode</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>CarrierCode</design:label>
            <design:formattingHints>
              <design:displaySize>3</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>isFinalized</design:name>
              <design:position>6</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>4</design:nativeDataTypeCode>
            <design:precision>10</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>isFinalized</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>isFinalized</design:label>
            <design:formattingHints>
              <design:displaySize>11</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
      </design:resultSetColumns>
      <design:criteria/>
    </design:resultSetDefinitions>
  </design:ResultSets>
</model:DesignValues>]]></xml-property>
        </oda-data-set>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="Data Set1" id="126">
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">FlightKey</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">FlightKey</text-property>
                    <text-property name="heading">FlightKey</text-property>
                </structure>
                <structure>
                    <property name="columnName">outFlightId</property>
                    <property name="analysis">measure</property>
                    <text-property name="displayName">outFlightId</text-property>
                    <text-property name="heading">outFlightId</text-property>
                </structure>
                <structure>
                    <property name="columnName">airport</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">airport</text-property>
                    <text-property name="heading">airport</text-property>
                </structure>
                <structure>
                    <property name="columnName">standardEstimatedDateTime</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">standardEstimatedDateTime</text-property>
                    <text-property name="heading">standardEstimatedDateTime</text-property>
                </structure>
                <structure>
                    <property name="columnName">inFlightId</property>
                    <property name="analysis">measure</property>
                    <text-property name="displayName">inFlightId</text-property>
                    <text-property name="heading">inFlightId</text-property>
                </structure>
                <structure>
                    <property name="columnName">tenantId</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">tenantId</text-property>
                    <text-property name="heading">tenantId</text-property>
                </structure>
                <structure>
                    <property name="columnName">flightAndDate</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">flightAndDate</text-property>
                    <text-property name="heading">flightAndDate</text-property>
                </structure>
                <structure>
                    <property name="columnName">airportAndSTDTime</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">airportAndSTDTime</text-property>
                    <text-property name="heading">airportAndSTDTime</text-property>
                </structure>
            </list-property>
            <list-property name="parameters">
                <structure>
                    <property name="name">param_1</property>
                    <property name="dataType">integer</property>
                    <property name="position">1</property>
                    <expression name="defaultValue" type="javascript">0</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_2</property>
                    <property name="dataType">integer</property>
                    <property name="position">2</property>
                    <expression name="defaultValue" type="javascript">0</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_3</property>
                    <property name="dataType">integer</property>
                    <property name="position">3</property>
                    <expression name="defaultValue" type="javascript">0</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_4</property>
                    <property name="dataType">integer</property>
                    <property name="position">4</property>
                    <expression name="defaultValue" type="javascript">0</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_5</property>
                    <property name="dataType">integer</property>
                    <property name="position">5</property>
                    <expression name="defaultValue" type="javascript">0</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">FlightKey</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">outFlightId</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">airport</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">standardEstimatedDateTime</property>
                        <property name="dataType">date-time</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">inFlightId</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">tenantId</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">flightAndDate</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">airportAndSTDTime</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">FlightKey</property>
                    <property name="nativeName">FlightKey</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">outFlightId</property>
                    <property name="nativeName">outFlightId</property>
                    <property name="dataType">decimal</property>
                    <property name="nativeDataType">2</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">airport</property>
                    <property name="nativeName">airport</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">standardEstimatedDateTime</property>
                    <property name="nativeName">standardEstimatedDateTime</property>
                    <property name="dataType">date-time</property>
                    <property name="nativeDataType">93</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">inFlightId</property>
                    <property name="nativeName">inFlightId</property>
                    <property name="dataType">integer</property>
                    <property name="nativeDataType">4</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">tenantId</property>
                    <property name="nativeName">tenantId</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">7</property>
                    <property name="name">flightAndDate</property>
                    <property name="nativeName">flightAndDate</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">8</property>
                    <property name="name">airportAndSTDTime</property>
                    <property name="nativeName">airportAndSTDTime</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[select 
	flight.FlightKey,
	flight.Flight_ID outFlightId,
	leg.FlightOffPoint airport,
	isNull(leg.DateETD,leg.DateSTD) standardEstimatedDateTime,
	? inFlightId,
	'SIN' tenantId,
	concat(flight.FlightKey,' - ',CAST(UPPER(FORMAT(isNull(leg.DateETD,leg.DateSTD) , 'ddMMMyyy', 'en-US')) as varchar)) flightAndDate,
	concat(leg.FlightOffPoint,' - ', FORMAT(isNull(leg.DateETD,leg.DateSTD) , 'HH:mm', 'en-US')) airportAndSTDTime
from  
	Flt_OperativeFlight flight inner join 
	Flt_OperativeFlight_Legs leg on leg.Flight_ID = flight.Flight_ID
where 
	leg.FlightBoardPoint='SIN' and 
	flight.Flight_ID in (
		select 
			distinct 
				outbound.FlightId outboundFlightId 
			from 
				Exp_ShipmentFlightBookingDetail inbound inner join 
				Exp_ShipmentFlightBookingDetail outbound
					on inbound.BookingId = outbound.BookingId
						and outbound.OutwardBookingFlag = inbound.OutwardBookingFlag+1
		where 
			inbound.FlightId=?
		union
		select 
			distinct 
				outbound.OutboundFlightId 
			from 
				Transhipment_TTWAOutboundFlight outbound inner join 
				Transhipment_TTWAConnectingFlight inbound
					on outbound.TransTTWAOutboundFlightId = inbound.TransTTWAOutboundFlightId
		where 
			inbound.InboundFlightId=?
	)
	UNION
	select 			
	null FlightKey,
	0 outFlightId,
	null airport,
	null standardEstimatedDateTime,
	? inFlightId,
	'SIN' tenantId,
	'-' flightAndDate,
	'-' airportAndSTDTime
	from
	(select flight.* from Imp_ArrivalManifestShipmentInfo shipment
	inner join Imp_ArrivalManifestULD uld
	on uld.ImpArrivalManifestULDId = shipment.ImpArrivalManifestULDId
	inner join Imp_ArrivalManifestBySegment segment
	on uld.ImpArrivalManifestBySegmentId = segment.ImpArrivalManifestBySegmentId
	inner join Imp_ArrivalManifestByFlight flight
	on flight.ImpArrivalManifestByFlightId = segment.ImpArrivalManifestByFlightId
	where flight.FlightId= ?
	and shipment.BookingFlightId is null
	and shipment.Origin !='SIN'
	and shipment.Destination !='SIN') data]]></xml-property>
            <xml-property name="designerValues"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<model:DesignValues xmlns:design="http://www.eclipse.org/datatools/connectivity/oda/design" xmlns:model="http://www.eclipse.org/birt/report/model/adapter/odaModel">
  <Version>2.0</Version>
  <design:ResultSets derivedMetaData="true">
    <design:resultSetDefinitions>
      <design:resultSetColumns>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>FlightKey</design:name>
              <design:position>1</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>8</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>FlightKey</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>FlightKey</design:label>
            <design:formattingHints>
              <design:displaySize>8</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>outFlightId</design:name>
              <design:position>2</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>2</design:nativeDataTypeCode>
            <design:precision>15</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>outFlightId</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>outFlightId</design:label>
            <design:formattingHints>
              <design:displaySize>17</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>airport</design:name>
              <design:position>3</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>3</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>airport</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>airport</design:label>
            <design:formattingHints>
              <design:displaySize>3</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>standardEstimatedDateTime</design:name>
              <design:position>4</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>93</design:nativeDataTypeCode>
            <design:precision>23</design:precision>
            <design:scale>3</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>standardEstimatedDateTime</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>standardEstimatedDateTime</design:label>
            <design:formattingHints>
              <design:displaySize>23</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>inFlightId</design:name>
              <design:position>5</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>4</design:nativeDataTypeCode>
            <design:precision>10</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>inFlightId</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>inFlightId</design:label>
            <design:formattingHints>
              <design:displaySize>11</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
      </design:resultSetColumns>
      <design:criteria/>
    </design:resultSetDefinitions>
  </design:ResultSets>
</model:DesignValues>]]></xml-property>
        </oda-data-set>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="Data Set2" id="166">
            <property name="nullsOrdering">nulls lowest</property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">transferType</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">transferType</text-property>
                    <text-property name="heading">transferType</text-property>
                </structure>
            </list-property>
            <list-property name="parameters">
                <structure>
                    <property name="name">param_1</property>
                    <property name="dataType">integer</property>
                    <property name="position">1</property>
                    <expression name="defaultValue" type="javascript">0</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_2</property>
                    <property name="dataType">integer</property>
                    <property name="position">2</property>
                    <expression name="defaultValue" type="javascript">0</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_3</property>
                    <property name="dataType">integer</property>
                    <property name="position">3</property>
                    <expression name="defaultValue" type="javascript">0</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_4</property>
                    <property name="dataType">integer</property>
                    <property name="position">4</property>
                    <expression name="defaultValue" type="javascript">0</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_5</property>
                    <property name="dataType">integer</property>
                    <property name="position">5</property>
                    <expression name="defaultValue" type="javascript">0</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_6</property>
                    <property name="dataType">integer</property>
                    <property name="position">6</property>
                    <expression name="defaultValue" type="javascript">0</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_7</property>
                    <property name="dataType">integer</property>
                    <property name="position">7</property>
                    <expression name="defaultValue" type="javascript">0</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_8</property>
                    <property name="dataType">integer</property>
                    <property name="position">8</property>
                    <expression name="defaultValue" type="javascript">0</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_9</property>
                    <property name="dataType">integer</property>
                    <property name="position">9</property>
                    <expression name="defaultValue" type="javascript">0</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_10</property>
                    <property name="dataType">integer</property>
                    <property name="position">10</property>
                    <expression name="defaultValue" type="javascript">0</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_11</property>
                    <property name="dataType">integer</property>
                    <property name="position">11</property>
                    <expression name="defaultValue" type="javascript">0</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_12</property>
                    <property name="dataType">integer</property>
                    <property name="position">12</property>
                    <expression name="defaultValue" type="javascript">0</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">transferType</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">transferType</property>
                    <property name="nativeName">transferType</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[select string_agg(transferData,' | ') transferType from 
(select concat(transferData.transferType,'(',count(1),')') transferData
from 
	(select distinct shipment.ShipmentNumber,shipment.ShipmentDate,shipment.TransferType transferType from Transhipment_TTWAConnectingFlightShipment shipment 
	inner join Transhipment_TTWAConnectingFlight inbound
	on shipment.TransTTWAConnectingFlightId = inbound.TransTTWAConnectingFlightId
	inner join Transhipment_TTWAOutboundFlight outbound
	on outbound.TransTTWAOutboundFlightId = inbound.TransTTWAOutboundFlightId
	inner join Imp_ArrivalManifestByFlight manifest
	on manifest.FlightId = inbound.InboundFlightId
	where outbound.OutboundFlightId=?  --outFlightId
	and inbound.InboundFlightId = ?  -- inFlightId
	UNION
	select distinct 
	inboundShipment.ShipmentNumber,inboundShipment.ShipmentDate
	,inboundShipment.TransferType transferType 
	from Imp_ArrivalManifestByFlight manifest
	inner join Imp_ArrivalManifestBySegment segment
	on manifest.ImpArrivalManifestByFlightId = segment.ImpArrivalManifestByFlightId
	left join Imp_ArrivalManifestULD uld
	on segment.ImpArrivalManifestBySegmentId = uld.ImpArrivalManifestBySegmentId
	inner join Imp_ArrivalManifestShipmentInfo inboundShipment
	on inboundShipment.ImpArrivalManifestULDId = uld.ImpArrivalManifestULDId
	inner join Exp_ShipmentBooking booking
	on booking.ShipmentNumber = inboundShipment.ShipmentNumber
	and booking.ShipmentDate = inboundShipment.ShipmentDate
	inner join Exp_ShipmentFlightBookingDetail bookingFlight
	on booking.BookingId =bookingFlight.BookingId 
	and inboundShipment.BookingFlightId = bookingFlight.FlightId
	where bookingFlight.FlightId=? --outFlightId
	and manifest.FlightId = ?  -- inFlightId
	and not exists(select * from Transhipment_TTWAConnectingFlightShipment shipment 
	inner join Transhipment_TTWAConnectingFlight inbound
	on shipment.TransTTWAConnectingFlightId = inbound.TransTTWAConnectingFlightId
	inner join Transhipment_TTWAOutboundFlight outbound
	on outbound.TransTTWAOutboundFlightId = inbound.TransTTWAOutboundFlightId
	inner join Imp_ArrivalManifestByFlight manifest
	on manifest.FlightId = inbound.InboundFlightId
	where outbound.OutboundFlightId=? --outFlightId
	and inbound.InboundFlightId = ?)  -- inFlightId
	UNION
	select distinct 
	shipment.ShipmentNumber,shipment.ShipmentDate
	,shipment.TransferType transferType from Imp_ArrivalManifestShipmentInfo shipment
	inner join Imp_ArrivalManifestULD uld
	on uld.ImpArrivalManifestULDId = shipment.ImpArrivalManifestULDId
	inner join Imp_ArrivalManifestBySegment segment
	on uld.ImpArrivalManifestBySegmentId = segment.ImpArrivalManifestBySegmentId
	inner join Imp_ArrivalManifestByFlight flight
	on flight.ImpArrivalManifestByFlightId = segment.ImpArrivalManifestByFlightId
	where flight.FlightId= ?  -- inFlightId
	and shipment.BookingFlightId is null
	and iif(? is null or ? = 0, null, ?) is null   --outFlightId
	and shipment.Origin !='SIN'
	and shipment.Destination !='SIN'
	UNION
	select distinct 
	booking.ShipmentNumber,booking.ShipmentDate
	,flightBooking.TransferType transferType from Exp_ShipmentFlightBookingDetail flightBooking
	inner join Exp_ShipmentFlightBookingDetail incomingFlightBooking
	on flightBooking.BookingId = incomingFlightBooking.BookingId
	and incomingFlightBooking.OutwardBookingFlag + 1 = flightBooking.OutwardBookingFlag
	inner join Exp_ShipmentBooking booking
	on flightBooking.BookingId = booking.BookingId
	left join Imp_ArrivalManifestShipmentInfo shipment
	on booking.ShipmentNumber = shipment.ShipmentNumber
	and booking.ShipmentDate= shipment.ShipmentDate
	left join Imp_ArrivalManifestULD uld
	on uld.ImpArrivalManifestULDId = shipment.ImpArrivalManifestULDId
	left join Imp_ArrivalManifestBySegment segment
	on uld.ImpArrivalManifestBySegmentId = segment.ImpArrivalManifestBySegmentId
	left join Imp_ArrivalManifestByFlight flight
	on flight.ImpArrivalManifestByFlightId = segment.ImpArrivalManifestByFlightId
	where flightBooking.FlightId= ?  --outFlightId
	and incomingFlightBooking.FlightId= ?  -- inFlightId
	and booking.Origin !='SIN'
	and booking.Destination !='SIN'
	and shipment.ShipmentNumber is null
	) transferData
group by transferData.transferType) tab]]></xml-property>
            <xml-property name="designerValues"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<model:DesignValues xmlns:design="http://www.eclipse.org/datatools/connectivity/oda/design" xmlns:model="http://www.eclipse.org/birt/report/model/adapter/odaModel">
  <Version>2.0</Version>
  <design:ResultSets derivedMetaData="true">
    <design:resultSetDefinitions>
      <design:resultSetColumns>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>transferType</design:name>
              <design:position>1</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>20</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>transferType</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>transferType</design:label>
            <design:formattingHints>
              <design:displaySize>20</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>number</design:name>
              <design:position>2</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>4</design:nativeDataTypeCode>
            <design:precision>10</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>number</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>number</design:label>
            <design:formattingHints>
              <design:displaySize>11</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
      </design:resultSetColumns>
      <design:criteria/>
    </design:resultSetDefinitions>
  </design:ResultSets>
</model:DesignValues>]]></xml-property>
        </oda-data-set>
    </data-sets>
    <page-setup>
        <simple-master-page name="Simple MasterPage" id="2"/>
    </page-setup>
    <body>
        <list id="326">
            <property name="dataSet">Data Set</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">FlightKey</property>
                    <text-property name="displayName">FlightKey</text-property>
                    <expression name="expression" type="javascript">dataSetRow["FlightKey"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Flight_ID</property>
                    <text-property name="displayName">Flight_ID</text-property>
                    <expression name="expression" type="javascript">dataSetRow["Flight_ID"]</expression>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="name">airport</property>
                    <text-property name="displayName">airport</text-property>
                    <expression name="expression" type="javascript">dataSetRow["airport"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">standardEstimatedDateTime</property>
                    <text-property name="displayName">standardEstimatedDateTime</text-property>
                    <expression name="expression" type="javascript">dataSetRow["standardEstimatedDateTime"]</expression>
                    <property name="dataType">date-time</property>
                </structure>
                <structure>
                    <property name="name">CarrierCode</property>
                    <text-property name="displayName">CarrierCode</text-property>
                    <expression name="expression" type="javascript">dataSetRow["CarrierCode"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">isFinalized</property>
                    <text-property name="displayName">isFinalized</text-property>
                    <expression name="expression" type="javascript">dataSetRow["isFinalized"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">tenantId</property>
                    <text-property name="displayName">tenantId</text-property>
                    <expression name="expression" type="javascript">dataSetRow["tenantId"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">dateAndAirport</property>
                    <text-property name="displayName">dateAndAirport</text-property>
                    <expression name="expression" type="javascript">dataSetRow["dateAndAirport"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">stdTime</property>
                    <text-property name="displayName">stdTime</text-property>
                    <expression name="expression" type="javascript">dataSetRow["stdTime"]</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <detail>
                <grid id="327">
                    <column id="328">
                        <property name="width">3in</property>
                    </column>
                    <column id="329"/>
                    <row id="330">
                        <cell id="331">
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <label id="342">
                                <property name="textAlign">center</property>
                            </label>
                            <data id="339">
                                <property name="fontWeight">bold</property>
                                <property name="textAlign">center</property>
                                <property name="resultSetColumn">FlightKey</property>
                            </data>
                        </cell>
                        <cell id="332">
                            <property name="colSpan">1</property>
                            <property name="rowSpan">3</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <list id="343">
                                <property name="dataSet">Data Set1</property>
                                <list-property name="paramBindings">
                                    <structure>
                                        <property name="paramName">param_1</property>
                                        <simple-property-list name="expression">
                                            <value type="javascript">row["Flight_ID"]</value>
                                        </simple-property-list>
                                    </structure>
                                    <structure>
                                        <property name="paramName">param_2</property>
                                        <simple-property-list name="expression">
                                            <value type="javascript">row["Flight_ID"]</value>
                                        </simple-property-list>
                                    </structure>
                                    <structure>
                                        <property name="paramName">param_4</property>
                                        <simple-property-list name="expression">
                                            <value type="javascript">row["Flight_ID"]</value>
                                        </simple-property-list>
                                    </structure>
                                    <structure>
                                        <property name="paramName">param_3</property>
                                        <simple-property-list name="expression">
                                            <value type="javascript">row["Flight_ID"]</value>
                                        </simple-property-list>
                                    </structure>
                                    <structure>
                                        <property name="paramName">param_5</property>
                                        <simple-property-list name="expression">
                                            <value type="javascript">row["Flight_ID"]</value>
                                        </simple-property-list>
                                    </structure>
                                </list-property>
                                <list-property name="boundDataColumns">
                                    <structure>
                                        <property name="name">FlightKey</property>
                                        <text-property name="displayName">FlightKey</text-property>
                                        <expression name="expression" type="javascript">dataSetRow["FlightKey"]</expression>
                                        <property name="dataType">string</property>
                                    </structure>
                                    <structure>
                                        <property name="name">outFlightId</property>
                                        <text-property name="displayName">outFlightId</text-property>
                                        <expression name="expression" type="javascript">dataSetRow["outFlightId"]</expression>
                                        <property name="dataType">decimal</property>
                                    </structure>
                                    <structure>
                                        <property name="name">airport</property>
                                        <text-property name="displayName">airport</text-property>
                                        <expression name="expression" type="javascript">dataSetRow["airport"]</expression>
                                        <property name="dataType">string</property>
                                    </structure>
                                    <structure>
                                        <property name="name">standardEstimatedDateTime</property>
                                        <text-property name="displayName">standardEstimatedDateTime</text-property>
                                        <expression name="expression" type="javascript">dataSetRow["standardEstimatedDateTime"]</expression>
                                        <property name="dataType">date-time</property>
                                    </structure>
                                    <structure>
                                        <property name="name">inFlightId</property>
                                        <text-property name="displayName">inFlightId</text-property>
                                        <expression name="expression" type="javascript">dataSetRow["inFlightId"]</expression>
                                        <property name="dataType">integer</property>
                                    </structure>
                                    <structure>
                                        <property name="name">tenantId</property>
                                        <text-property name="displayName">tenantId</text-property>
                                        <expression name="expression" type="javascript">dataSetRow["tenantId"]</expression>
                                        <property name="dataType">string</property>
                                    </structure>
                                    <structure>
                                        <property name="name">flightAndDate</property>
                                        <text-property name="displayName">flightAndDate</text-property>
                                        <expression name="expression" type="javascript">dataSetRow["flightAndDate"]</expression>
                                        <property name="dataType">string</property>
                                    </structure>
                                    <structure>
                                        <property name="name">airportAndSTDTime</property>
                                        <text-property name="displayName">airportAndSTDTime</text-property>
                                        <expression name="expression" type="javascript">dataSetRow["airportAndSTDTime"]</expression>
                                        <property name="dataType">string</property>
                                    </structure>
                                </list-property>
                                <detail>
                                    <grid id="344">
                                        <property name="backgroundColor">#C0C0C0</property>
                                        <column id="345"/>
                                        <row id="346">
                                            <cell id="347">
                                                <label id="354">
                                                    <property name="backgroundColor">#FFFFFF</property>
                                                    <property name="textAlign">center</property>
                                                </label>
                                                <data id="352">
                                                    <property name="textAlign">center</property>
                                                    <property name="resultSetColumn">flightAndDate</property>
                                                </data>
                                            </cell>
                                        </row>
                                        <row id="348">
                                            <cell id="349">
                                                <data id="353">
                                                    <property name="textAlign">center</property>
                                                    <property name="resultSetColumn">airportAndSTDTime</property>
                                                </data>
                                            </cell>
                                        </row>
                                        <row id="350">
                                            <cell id="351">
                                                <table id="355">
                                                    <property name="dataSet">Data Set2</property>
                                                    <list-property name="paramBindings">
                                                        <structure>
                                                            <property name="paramName">param_1</property>
                                                            <simple-property-list name="expression">
                                                                <value type="javascript">row["outFlightId"]</value>
                                                            </simple-property-list>
                                                        </structure>
                                                        <structure>
                                                            <property name="paramName">param_3</property>
                                                            <simple-property-list name="expression">
                                                                <value type="javascript">row["outFlightId"]</value>
                                                            </simple-property-list>
                                                        </structure>
                                                        <structure>
                                                            <property name="paramName">param_5</property>
                                                            <simple-property-list name="expression">
                                                                <value type="javascript">row["outFlightId"]</value>
                                                            </simple-property-list>
                                                        </structure>
                                                        <structure>
                                                            <property name="paramName">param_8</property>
                                                            <simple-property-list name="expression">
                                                                <value type="javascript">row["outFlightId"]</value>
                                                            </simple-property-list>
                                                        </structure>
                                                        <structure>
                                                            <property name="paramName">param_9</property>
                                                            <simple-property-list name="expression">
                                                                <value type="javascript">row["outFlightId"]</value>
                                                            </simple-property-list>
                                                        </structure>
                                                        <structure>
                                                            <property name="paramName">param_2</property>
                                                            <simple-property-list name="expression">
                                                                <value type="javascript">row["inFlightId"]</value>
                                                            </simple-property-list>
                                                        </structure>
                                                        <structure>
                                                            <property name="paramName">param_4</property>
                                                            <simple-property-list name="expression">
                                                                <value type="javascript">row["inFlightId"]</value>
                                                            </simple-property-list>
                                                        </structure>
                                                        <structure>
                                                            <property name="paramName">param_7</property>
                                                            <simple-property-list name="expression">
                                                                <value type="javascript">row["inFlightId"]</value>
                                                            </simple-property-list>
                                                        </structure>
                                                        <structure>
                                                            <property name="paramName">param_6</property>
                                                            <simple-property-list name="expression">
                                                                <value type="javascript">row["inFlightId"]</value>
                                                            </simple-property-list>
                                                        </structure>
                                                        <structure>
                                                            <property name="paramName">param_10</property>
                                                            <simple-property-list name="expression">
                                                                <value type="javascript">row["outFlightId"]</value>
                                                            </simple-property-list>
                                                        </structure>
                                                        <structure>
                                                            <property name="paramName">param_11</property>
                                                            <simple-property-list name="expression">
                                                                <value type="javascript">row["outFlightId"]</value>
                                                            </simple-property-list>
                                                        </structure>
                                                        <structure>
                                                            <property name="paramName">param_12</property>
                                                            <simple-property-list name="expression">
                                                                <value type="javascript">row["inFlightId"]</value>
                                                            </simple-property-list>
                                                        </structure>
                                                    </list-property>
                                                    <list-property name="boundDataColumns">
                                                        <structure>
                                                            <property name="name">transferType</property>
                                                            <text-property name="displayName">transferType</text-property>
                                                            <expression name="expression" type="javascript">dataSetRow["transferType"]</expression>
                                                            <property name="dataType">string</property>
                                                        </structure>
                                                    </list-property>
                                                    <column id="362"/>
                                                    <detail>
                                                        <row id="358">
                                                            <cell id="359">
                                                                <data id="363">
                                                                    <property name="fontWeight">bold</property>
                                                                    <property name="textAlign">center</property>
                                                                    <property name="resultSetColumn">transferType</property>
                                                                </data>
                                                            </cell>
                                                        </row>
                                                    </detail>
                                                </table>
                                            </cell>
                                        </row>
                                    </grid>
                                </detail>
                            </list>
                        </cell>
                    </row>
                    <row id="333">
                        <cell id="334">
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <data id="340">
                                <property name="fontWeight">bold</property>
                                <property name="textAlign">center</property>
                                <property name="resultSetColumn">dateAndAirport</property>
                            </data>
                        </cell>
                    </row>
                    <row id="336">
                        <cell id="337">
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <data id="341">
                                <property name="fontWeight">bold</property>
                                <property name="textAlign">center</property>
                                <property name="resultSetColumn">stdTime</property>
                            </data>
                        </cell>
                    </row>
                </grid>
            </detail>
        </list>
    </body>
</report>
