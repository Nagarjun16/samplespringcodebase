<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.23" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 4.6.0.v201606072122</property>
    <property name="units">in</property>
    <property name="iconFile">/templates/blank_report.gif</property>
    <property name="bidiLayoutOrientation">ltr</property>
    <property name="imageDPI">96</property>
    <parameters>
        <scalar-parameter name="Carrier" id="7">
            <property name="valueType">static</property>
            <property name="isRequired">true</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="concealValue">false</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="Month" id="8">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="Year" id="9">
            <property name="valueType">static</property>
            <property name="dataType">integer</property>
            <property name="distinct">true</property>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="tenantID" id="49">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <oda-data-source extensionID="org.eclipse.birt.report.data.oda.jdbc" name="Data Source" id="4">
            <list-property name="privateDriverProperties">
                <ex-property>
                    <name>metadataBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledMetadataBidiFormatStr</name>
                </ex-property>
                <ex-property>
                    <name>contentBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledContentBidiFormatStr</name>
                </ex-property>
            </list-property>
            <property name="odaDriverClass">com.microsoft.sqlserver.jdbc.SQLServerDriver</property>
            <property name="odaURL">jdbc:sqlserver://cosysuatsqldb1server.database.windows.net;databaseName=NGCUAT</property>
            <property name="odaUser">SATsDevUser</property>
            <encrypted-property name="odaPassword" encryptionID="base64">U0B0cyMxNDIx</encrypted-property>
        </oda-data-source>
    </data-sources>
    <data-sets>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="Data_Set_01" id="5">
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">CarrierCode</property>
                    <property name="alias">CarrierCode</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">CarrierCode</text-property>
                    <text-property name="heading">CarrierCode</text-property>
                </structure>
                <structure>
                    <property name="columnName">FlightNumber</property>
                    <property name="alias">FlightNumber</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">FlightNumber</text-property>
                    <text-property name="heading">FlightNumber</text-property>
                </structure>
            </list-property>
            <list-property name="parameters">
                <structure>
                    <property name="name">param_1</property>
                    <property name="paramName">tenantID</property>
                    <property name="dataType">string</property>
                    <property name="position">1</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_2</property>
                    <property name="paramName">Month</property>
                    <property name="dataType">string</property>
                    <property name="position">2</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_3</property>
                    <property name="paramName">Year</property>
                    <property name="dataType">integer</property>
                    <property name="position">3</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_4</property>
                    <property name="paramName">Carrier</property>
                    <property name="dataType">string</property>
                    <property name="position">4</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_5</property>
                    <property name="paramName">tenantID</property>
                    <property name="dataType">string</property>
                    <property name="position">5</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_6</property>
                    <property name="paramName">tenantID</property>
                    <property name="dataType">string</property>
                    <property name="position">6</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_7</property>
                    <property name="paramName">tenantID</property>
                    <property name="dataType">string</property>
                    <property name="position">7</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">date_arrival</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">CarrierCode</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">FlightNumber</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">Weight</property>
                        <property name="dataType">decimal</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">date_arrival</property>
                    <property name="nativeName">date_arrival</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">CarrierCode</property>
                    <property name="nativeName">CarrierCode</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">FlightNumber</property>
                    <property name="nativeName">FlightNumber</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">Weight</property>
                    <property name="nativeName">Weight</property>
                    <property name="dataType">decimal</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[WITH 
Flt AS (Select leg.Flight_ID FlightId, Flt.CarrierCode, Flt.FlightNumber, Flt.FlightKey, Leg.DateSTA, Leg.DateATA,
Flt.FlightOriginDate  InboundFlightOriginDate,flt.FlightType  InboundFlightType,leg.DateETA,
               leg.AircraftType, leg.FlightBoardPoint InboundFlightBoardPoint,
			   case when AcTyp.AircraftBodyType='N' then 'NARROW' else 'WIDE' end InboundAircraftBodyType
         From Flt_OperativeFlight Flt
		 INNER JOIN Flt_OperativeFlight_Legs leg ON leg.Flight_ID = Flt.Flight_ID
		 LEFT JOIN Mst_AircraftType AcTyp ON leg.AircraftType= AcTyp.AircraftType
		 WHERE Leg.FlightOffPoint = ?     
		   AND ( (Flt.carriercode in ('MU','CK') AND cast(Leg.DATESTA as date) >= '11-DEC-2018')
			      OR (Flt.carriercode in ('VJ','PN','RX') AND cast(Leg.DATESTA as date) >= '27-DEC-2018')
				  OR (Flt.carriercode in ('TG','BR','FJ','LO') AND cast(Leg.DATESTA as date) >= '03-JAN-2019')
				  OR (Flt.carriercode in ('BG','SL','OD','JT','ID','HU','GX','5J','3U') AND cast(Leg.DATESTA as date) >= '26-FEB-2019')
				  OR (Flt.carriercode in ('CZ','CV','LX','MF','NS','OZ','QZ','Z2','ZH','FD','AK','CA','JL','HO')	AND cast (Leg.DATESTA as date) >= '19-MAR-2019')
				  OR (Flt.carriercode in ('AI','7L','9W','PR','IX','BI','EY','ET','BS','SV','BL','HY') AND cast (Leg.DATESTA as date) >= '27-MAR-2019')
				  OR (Flt.carriercode = '3K' AND cast (Leg.DATESTA as date) BetWeen '27-MAR-2019' And '28-MAR-2019')
				  OR (Flt.carriercode In ('PX','VN') AND cast (Leg.DATESTA as date) BetWeen '27-MAR-2019' And '14-APR-2019')
				  OR (Flt.carriercode = 'UA' AND cast(Leg.DATESTA as date)  >= '30-APR-2019')
				  OR (Flt.carriercode = 'TK' AND cast(Leg.DATESTA as date)  >= '09-MAY-2019')				  
				  OR (Flt.carriercode In ('NH','NQ') AND cast(Leg.DATESTA as date)  >= '15-MAY-2019') 
				  OR (Flt.carriercode = 'CX' AND cast(Leg.DATESTA as date)  >= '21-MAY-2019')
				  OR (Flt.carriercode = 'KE' AND cast(Leg.DATESTA as date)  >= '28-MAY-2019')	
				  OR (Flt.carriercode = 'VN' AND cast(Leg.DATESTA as date)  >= '04-JUN-2019')
				  OR (Flt.carriercode = '3K' AND cast(Leg.DATESTA as date)  >= '11-JUN-2019')
				  OR (Flt.carriercode = 'KZ' AND cast(Leg.DATESTA as date)  >= '12-JUN-2019')	
				  OR (Flt.carriercode = 'FX' AND cast(Leg.DATESTA as date)  >= '18-JUN-2019')	
				  OR (Flt.carriercode = 'RU' AND cast(Leg.DATESTA as date)  >= '25-JUN-2019')
				  OR (Flt.carriercode In ('TH','N7') AND cast(Leg.DATESTA as date)  >= '02-JUL-2019')	
				   OR ( Flt.carriercode = 'LH' AND Cast(Leg.datesta AS DATE) >= '11-JUL-2019' ) 
				   OR ( Flt.carriercode = '8K' AND Cast(Leg.datesta AS DATE) >= '16-JUL-2019' ) 
				   OR ( Flt.carriercode = '3S' AND Cast(Leg.datesta AS DATE) >= '19-JUL-2019' ) 
				   OR ( Flt.carriercode = 'JQ' AND Cast(Leg.datesta AS DATE) >= '29-JUL-2019' ) 
				   OR ( Flt.carriercode = 'QF' AND Cast(Leg.datesta AS DATE) >= '29-JUL-2019' ) 				  
				)
		    AND month(leg.DateSTA )=? and  Year(leg.DateSTA )=?  and Flt.carriercode = ?
),
FInSum AS (Select ShpVer.FlightId, ShpVer.ShipmentId, Sum(ShpVer.BreakDownPieces) Pieces, Sum(ShpVer.BreakDownWeight) Weight,
               Max(ShpVer.CreatedDateTime) FrtInDate
          from Imp_ShipmentVerification ShpVer
		  Where IsNull(ShpVer.BreakDownPieces,0) > 0
		Group By ShpVer.FlightId, ShpVer.ShipmentId
),
FOutSum AS (Select FrtOut.FlightId, FrtOut.ShipmentId, Sum(FrtOut.Pieces) Pieces, Sum(FrtOut.Weight) Weight
			from shipment_freightOut FrtOut
		Group By FrtOut.FlightId, FrtOut.ShipmentId
),
DO As (Select FrtOut.FlightId, FrtOut.ShipmentId, IsNull(FrtOut.ShipmentLocation,FrtOut.WarehouseLocation) Location, 
				   Sum(FrtOut.Pieces) Pieces, Sum(FrtOut.Weight) Weight,
				   Max(FrtOut.DeliveryRequestIssuedOn) PODate, Dlv.DeliveryOrderNo DeliveryOrderNo, 
				   Max(FrtOut.DeliveredOn) DeliveryDate,
				   Dlv.CustomerCode, cus.CustomerShortName CustomerName
			from shipment_freightOut FrtOut 
			Inner Join Imp_Delivery Dlv On Dlv.ShipmentId = FrtOut.ShipmentId 
			                            And Dlv.ImpDeliveryId = FrtOut.DeliveryOrderNo
			                           --And IsNULL(dlv.Status,'#') = 'COMPLETED'
			Inner Join Customer_master cus on cus.CustomerCode = Dlv.CustomerCode
			Group By FrtOut.FlightId, FrtOut.ShipmentId, IsNull(FrtOut.ShipmentLocation,FrtOut.WarehouseLocation), 
			         Dlv.DeliveryOrderNo, Dlv.CustomerCode, cus.CustomerShortName
			Union All
            Select FrtOut.FlightId, FrtOut.ShipmentId, IsNull(FrtOut.ShipmentLocation,FrtOut.WarehouseLocation) Location, 
				   Sum(FrtOut.Pieces) Pieces, Sum(FrtOut.Weight) Weight,
				   Max(FrtOut.DeliveryRequestIssuedOn) PODate, Dlv.DeliveryOrderNo DeliveryOrderNo, 
				   Max(FrtOut.DeliveredOn) DlvDate,
				   'IXX' CustomerCode, Dlv.CustomerCode CustomerName
			from shipment_freightOut FrtOut 
			Inner Join Imp_Delivery Dlv On Dlv.ShipmentId = FrtOut.ShipmentId And Dlv.ImpDeliveryId = FrtOut.DeliveryOrderNo
			                            --And dlv.Status = 'COMPLETED' 
										And Dlv.CustomerCode Not IN (select CustomerCode From Customer_master)
			Group By FrtOut.FlightId, FrtOut.ShipmentId, IsNull(FrtOut.ShipmentLocation,FrtOut.WarehouseLocation), 
			         Dlv.DeliveryOrderNo,  CustomerCode, Dlv.CustomerCode
),
FinDO AS (Select FInSum.FlightId, FInSum.ShipmentId, FInSum.FrtInDate, 
                 DO.Location, DO.Pieces, DO.Weight, DO.PODate, DO.DeliveryOrderNo, DO.DeliveryDate,
                 DO.CustomerCode, DO.CustomerName
            From FInSum 
			Inner Join FOutSum On FOutSum.FlightId = FInSum.FlightId 
			                   And FOutSum.ShipmentId = FInSum.ShipmentId
							   And FOutSum.Weight <= FInSum.Weight
			Inner Join Do On Do.FlightId = FOutSum.FlightId
			              And Do.ShipmentId = FOutSum.ShipmentId
			Union All
			Select FInSum.FlightId, FInSum.ShipmentId, FInSum.FrtInDate, 
                 '' Location, FInSum.Pieces, FInSum.Weight, '' PODate, '' DeliveryOrderNo, '' DeliveryDate,
                 '' CustomerCode, '' CustomerName
            From FInSum 
			Inner Join Flt On flt.FlightId = FInSum.FlightId
			Where Not Exists (Select 1 From FOutSum Where FOutSum.FlightId = FInSum.FlightId 
													  And FOutSum.ShipmentId = FInSum.ShipmentId)
			Union All
			Select	FInSum.FlightId, FInSum.ShipmentId, FInSum.FrtInDate, '' Location, (FInSum.Pieces-FOutSum.Pieces) Pieces, 
			       (FInSum.Weight-FOutSum.Weight) Weight, 
			       '' PODate, '' DeliveryOrderNo, '' DeliveryDate,
                   '' CustomerCode, ''CustomerName
            From FInSum 
			Inner Join FOutSum On FOutSum.FlightId = FInSum.FlightId 
			                   And FOutSum.ShipmentId = FInSum.ShipmentId
							   And FOutSum.Weight <= FInSum.Weight
							   And (FInSum.Weight-FOutSum.Weight) > 0
			Union All
			Select FInSum.FlightId, FInSum.ShipmentId, Max(FInSum.FrtInDate), Max(DO.Location) Location, 
			       Max(FInSum.Pieces) Pieces, Max(FInSum.Weight) Weight, 
			       Max(DO.PODate) PODate, Max(DO.DeliveryOrderNo) DeliveryOrderNo, Max(DO.DeliveryDate) DeliveryDate, 
				   Max(DO.CustomerCode) CustomerCode, Max(DO.CustomerName) CustomerName
            From FInSum 
			Inner Join FOutSum On FOutSum.FlightId = FInSum.FlightId 
			                   And FOutSum.ShipmentId = FInSum.ShipmentId
							   And FOutSum.Weight > FInSum.Weight
			Left Join Do On Do.FlightId = FOutSum.FlightId
			              And Do.ShipmentId = FOutSum.ShipmentId
			Group By FInSum.FlightId, FInSum.ShipmentId
),
FOutSHC AS (select Shc.FlightId, Shc.ShipmentId, Shc.Location, 
                   Shc.DeliveryOrderNo,                     										
                  STRING_AGG(Shc.SpecialHandlingCode,',') SpecialHandlingCode,														
			      Max(CASE WHEN SpecialHandlingCode IN ('RCX','REX','RXB','RXB','RXC','RXD',
														'RXE','RXG','RXS','RFG','RNG','RPG',
														'RFL','RFS','RSC','RFW','ROX','ROP',
														'RPB','RIS','RRW','RRY','RCM','RSB',
														'RMD','RLI','RLM','RCL','DGR','DGD',
														'RGX','RRE','ROP','RDS',
														'RCS','RDG','RXE','RXG')				
					   THEN 1 ELSE 0 END) DGR,									
				  Max(CASE WHEN Shc.SpecialHandlingCode IN ('PHC','PES','PEF','EAT','PEP','FRI','FRO','LHO','PEM','PER','PIL')										
					   THEN 1 ELSE 0 END) PER,									
                  Max(CASE WHEN Shc.SpecialHandlingCode IN ('BUP') THEN 1 ELSE 0 END) BUP,														
				  Max(CASE WHEN Shc.SpecialHandlingCode IN ('RAC') THEN 1 ELSE 0 END) EXP,
				  Max(CASE WHEN SpecialHandlingCode in ('BUC') THEN 1 ELSE 0 END) BUC,
				   Max(CASE WHEN SpecialHandlingCode in ('INT') THEN 1 ELSE 0 END) IntactFlag
		     from (Select  b.FlightId, b.ShipmentId, IsNull(b.ShipmentLocation,b.WarehouseLocation) location, c.DeliveryOrderNo,
			               a.SpecialHandlingCode
			        From shipment_freightoutShc a
						Inner Join shipment_freightout b On b.ShipmentFreightOutId = a.ShipmentFreightOutId
						Inner Join Imp_Delivery c On c.ShipmentId = b.ShipmentId 
							And c.ImpDeliveryId = b.DeliveryOrderNo
							Group By b.FlightId,  b.ShipmentId, IsNull(b.ShipmentLocation,b.WarehouseLocation), c.DeliveryOrderNo,
							a.SpecialHandlingCode
						) Shc						
		     Group By Shc.FlightId, Shc.ShipmentId, Shc.Location, Shc.DeliveryOrderNo
),
FInOut As (Select FinDO.FlightId, FinDO.ShipmentId, FinDO.FrtInDate, 
                  FinDO.Location, FinDO.Pieces, FinDO.Weight, FinDO.PODate, FinDO.DeliveryOrderNo, 
                  FinDO.DeliveryDate, FinDO.CustomerCode, FinDO.CustomerName, FOutSHC.SpecialHandlingCode, 
				  FOutSHC.DGR, FOutSHC.PER, FOutSHC.BUP, FOutSHC.EXP,FOutSHC.BUC,FOutSHC.IntactFlag
			From FinDO
			Left Join FOutSHC On FOutSHC.FlightId    = FinDO.FlightId 
			                  And FOutSHC.ShipmentId = FinDO.ShipmentId 
			                  And IsNull(FOutSHC.Location,'#')        = IsNull(FinDO.Location,'#')
			                  And IsNull(FOutSHC.DeliveryOrderNo,'#') = IsNull(FinDO.DeliveryOrderNo,'#')
),
TTH AS (select bkgDtl.FlightId, bkg.ShipmentNumber, bkg.ShipmentDate, 
               Max(bkgDtl.transfertype) TransferType 
				  
		     from Exp_ShipmentFlightBookingDetail bkgDtl
			Inner Join Exp_ShipmentBooking bkg On bkg.BookingId = bkgDtl.BookingId
			 Where IsNull(bkgDtl.BookingCancellationFlag,0) = 0
			 group by bkgDtl.FlightId, bkg.ShipmentNumber, bkg.ShipmentDate
),
CneAgt AS (select sc.ShipmentId, sc.CustomerCode ConsigneeCode, sc.CustomerName ConsigneeName, 
                  cm.CustomerCode AgentCode, cm.CustomerShortName AgentName
			 from Shipment_MasterCustomerInfo sc
			 Left Join Customer_master cm On cm.Customer_ID = sc.AppointedAgent
			 			where sc.CustomerType = 'CNE'

			
), 

Shipper AS (
       select sc.ShipmentId, sc.CustomerCode  ShipperCode, sc.CustomerName ShipperName 
                 
			 from Shipment_MasterCustomerInfo sc
			 Left Join Customer_master cm On cm.Customer_ID = sc.AppointedAgent
			where sc.CustomerType = 'SHP'
),
SHCMst AS (select mst.ShipmentId, STRING_AGG(SpecialHandlingCode,',') SpecialHandlingCode,														
			      Max(CASE WHEN SpecialHandlingCode IN ('RCX','REX','RXB','RXB','RXC','RXD',
														'RXE','RXG','RXS','RFG','RNG','RPG',
														'RFL','RFS','RSC','RFW','ROX','ROP',
														'RPB','RIS','RRW','RRY','RCM','RSB',
														'RMD','RLI','RLM','RCL','DGR','DGD',
														'RGX','RRE','ROP','RDS',
														'RCS','RDG','RXE','RXG')
						   THEN 1 ELSE 0 END) DGR,								
				  Max(CASE WHEN SpecialHandlingCode IN ('PHC','PES','PEF','EAT','PEP','FRI','FRO','LHO','PEM','PER','PIL')										
						   THEN 1 ELSE 0 END) PER,								
				  Max(CASE WHEN SpecialHandlingCode = 'BUP' THEN 1 ELSE 0 END) BUP,										
				  Max(CASE WHEN SpecialHandlingCode = 'RAC' THEN 1 ELSE 0 END) EXP,
				  Max(CASE WHEN SpecialHandlingCode = 'BUC' THEN 1 ELSE 0 END) BUC,
				  Max(CASE WHEN SpecialHandlingCode = 'INT' THEN 1 ELSE 0 END) IntactFlag
			 from Shipment_MasterSHC shc											
	   Inner Join Shipment_Master mst On mst.ShipmentId = shc.ShipmentId													
		 Group By mst.ShipmentId
),
FinData As (Select flt.DateSTA as DateATA,
flt.dateSta,
flt.DateETA,
Flt.FlightId,
flt.InboundAircraftBodyType,
Flt.InboundFlightBoardPoint,
flt.InboundFlightOriginDate,
flt.InboundFlightType,
sm.ShipmentNumber,
sm.ShipmentId,
sm.ShipmentDate,
sm.shipmentType,
Shipper.ShipperCode,
Shipper.ShipperName,
convert(varchar(16),flt.DateSTA,120) STADateTime, 
car.CarrierShortName,


																		
				flt.CarrierCode ArrivalFlightCarrier,  flt.FlightNumber ArrivalFlightNumber, 														
				SubString(sm.ShipmentNumber,1,3) AWBPrefix, SubString(sm.ShipmentNumber,4,8) AWBNumber, 
				sm.Origin, sm.Destination, 	
				convert(varchar(20),DATEADD(hour,8,FInOut.FrtInDate),120) FreightInDateTime,	
				CASE WHEN (FInOut.DGR = 1 OR SHCMst.DGR = 1) 
				     THEN 'Y' ELSE 'N' END DGR, 										
				CASE WHEN (FInOut.PER = 1 OR SHCMst.PER = 1) 
				     THEN 'Y' ELSE 'N' END PERISHABLES, 											
				CASE WHEN (FInOut.BUP = 1 OR SHCMst.BUP = 1) 
				     THEN 'Y' ELSE 'N' END "BUP OR NON", 											
				CASE WHEN (FInOut.EXP = 1 OR SHCMst.EXP = 1) 
				     THEN 'Y' ELSE 'N' END EXPRESS,	
					 CASE WHEN (FInOut.BUC = 1 OR SHCMst.BUC = 1) 
				     THEN 'Y' ELSE 'N' END BUC,	
					 CASE WHEN (FInOut.IntactFlag = 1 OR SHCMst.IntactFlag = 1) 
				     THEN 'Y' ELSE 'N' END IntactFlag,	
					 
				 --DONumber, 
				-- DOPrintDateTime,
				IsNull(SHCMst.SpecialHandlingCode,'.') SpecialHandlingCode,
				IsNull(CneAgt.AgentCode,'.')  IssuingAgentCode, 
				IsNull(CneAgt.AgentName,'.')   IssuingAgentName,										
				--'.' PickOrderDateTime, 										
				IsNull(CneAgt.ConsigneeName,'.') ConsigneeName,
				IsNull(CneAgt.ConsigneeCode,'.') ConsigneeCode,
				TTH.TransferType TransferType,
				'N' Transhipment,										
				FInOut.Weight SumWeight, FInOut.Pieces SumPieces, 										
				IsNull(sm.NatureOfGoodsDescription,'.') NOG, 										
			CASE WHEN (FInOut.PER = 1 OR SHCMst.PER = 1) THEN 'COOLPORT'										
				 WHEN (FInOut.EXP = 1 OR SHCMst.EXP = 1) THEN 'EXPRESS'									
				 WHEN Car.CarrierCode IN ('SQ','MI','TR','N7','TH','RU','8K','3S','NZ')	THEN 'SQ Import'								
				 ELSE 'OAL Import' End CostCentre, 								
				CAST(DATEADD(hour,8, FInOut.FrtInDate) AS Date) FreightIn,										
				IsNull(FInOut.Location,'.') Location,  
				  Case When Substring(FInOut.Location,1,3) In (select UldType from Uld_UldType)
				       Then Substring(FInOut.Location,1,3) Else 'BULK' End UlDType,
				  Case When Substring(FInOut.Location,1,3) In (select UldType from Uld_UldType)
				       Then Substring(FInOut.Location,4,10) Else '.' End UlDNumber,					
				flt.AircraftType AircraftType,
				IsNull(CONVERT(VARCHAR(16),DATEADD(hour,8,FInOut.DeliveryDate),120),'.') FreightOutDateTime
				

			from Shipment_Master sm
			Inner Join FInOut On FInOut.ShipmentId = sm.ShipmentId
			Inner Join Flt On Flt.FlightId = FInOut.FlightId
			Inner Join Mst_carrier Car On Car.CarrierCode = Flt.CarrierCode			  			  
			Left  Join TTH ON TTH.flightId       = FInOut.FlightId
							AND TTH.ShipmentNumber = sm.ShipmentNumber	
							AND TTH.ShipmentDate   = sm.ShipmentDate										
			Left  Join SHCMst ON SHCMst.ShipmentId  = FInOut.ShipmentId
			Left  Join CneAgt ON CneAgt.ShipmentId  = FInOut.ShipmentId
			
			Left  Join Shipper ON Shipper.ShipmentId  = FInOut.ShipmentId
			
			where sm.Destination   = ?
			  And sm.ShipmentType != 'MAIL'											
			  And sm.CancelledOn IS NULL		
		Union All
		Select flt.DateSTA as DateATA,
		flt.dateSta,
		flt.DateETA,
		Flt.FlightId,
flt.InboundAircraftBodyType,
Flt.InboundFlightBoardPoint,
flt.InboundFlightOriginDate,
flt.InboundFlightType,
sm.ShipmentNumber,
sm.ShipmentId,
sm.ShipmentDate,
sm.shipmentType,
Shipper.ShipperCode,
Shipper.ShipperName,
convert(varchar(16),flt.DateSTA,120) STADateTime, 
car.CarrierShortName,
flt.CarrierCode ArrivalFlightCarrier, flt.FlightNumber ArrivalFlightNumber, 														
SubString(sm.ShipmentNumber,1,3) AWBPrefix, SubString(sm.ShipmentNumber,4,8) AWBNumber, 
sm.Origin, 
sm.Destination, 
IsNull(convert(varchar(20),DATEADD(hour,8,FInSum.FrtInDate),120),'.')	FreightInDateTime,
CASE WHEN SHCMst.DGR = 1 
	 THEN 'Y' ELSE 'N' END DGR, 											
CASE WHEN SHCMst.PER = 1 
	 THEN 'Y' ELSE 'N' END PERISHABLES, 											
CASE WHEN SHCMst.BUP = 1 
	 THEN 'Y' ELSE 'N' END "BUP OR NON", 											
CASE WHEN SHCMst.EXP = 1 
	 THEN 'Y' ELSE 'N' END EXPRESS,
	 CASE WHEN SHCMst.BUC = 1 
	 THEN 'Y' ELSE 'N' END BUC,	
	 CASE WHEN SHCMst.IntactFlag = 1
				     THEN 'Y' ELSE 'N' END IntactFlag,	
					 
	 			
				 --DONumber, 
			-- DOPrintDateTime,
	
IsNull(SHCMst.SpecialHandlingCode,'.') SpecialHandlingCode,
IsNull(CneAgt.AgentCode,'.')  IssuingAgentCode, 
IsNull(CneAgt.AgentName,'.')   IssuingAgentName,										
--'.' PickOrderDateTime, 										
IsNull(CneAgt.ConsigneeName,'.') ConsigneeName,
IsNull(CneAgt.ConsigneeCode,'.') ConsigneeCode,
TTH.TransferType TransferType, 
											
'Y' Transhipment,										
FInSum.Weight SumWeight, 
FInSum.Pieces SumPieces, 
IsNull(sm.NatureOfGoodsDescription,'.') NOG, 										
CASE WHEN SHCMst.PER = 1 THEN 'COOLPORT'										
	 WHEN SHCMst.EXP = 1 THEN 'EXPRESS'									
	 WHEN Car.CarrierCode IN ('SQ','MI','TR','N7','TH','RU','8K','3S','NZ')	THEN 'SQ Import'								
ELSE 'OAL Import' End CostCentre, 
CAST(FInSum.FrtInDate AS Date) FreightIn,										
'.' Location,  
'.' UlDType, 
'.' UlDNumber,
flt.AircraftType AircraftType,
IsNull(CONVERT(VARCHAR(16),DATEADD(hour,8,FInSum.FrtInDate),120),'.') FreightOutDateTime
			

			from Shipment_Master sm
			Inner Join FInSum On FInSum.ShipmentId = sm.ShipmentId
			Inner Join Flt On Flt.FlightId = FInSum.FlightId
			Inner Join Mst_carrier Car On Car.CarrierCode = Flt.CarrierCode			  			  
			Left  Join TTH ON TTH.flightId         = FInSum.FlightId
							AND TTH.ShipmentNumber = sm.ShipmentNumber	
							AND TTH.ShipmentDate   = sm.ShipmentDate										
			Left  Join SHCMst ON SHCMst.ShipmentId     = FInSum.ShipmentId
			Left  Join CneAgt ON CneAgt.ShipmentId     = FInSum.ShipmentId
			
			Left  Join Shipper ON Shipper.ShipmentId    = FInSum.ShipmentId
			
			
			where sm.Origin       != ?
			  And sm.Destination  != ?
			  And sm.ShipmentType != 'MAIL'											
			  And sm.CancelledOn IS NULL
)

Select
format( dateSta,'dd-MMM-yyyy') as date_arrival,
ArrivalFlightCarrier	as	CarrierCode,
ArrivalFlightNumber	as	FlightNumber,
sum(SumWeight) Weight
from finData   group by format( DateATA,'dd-MMM-yyyy'),ArrivalFlightCarrier,ArrivalFlightNumber,dateSta
order by format( dateSta,'dd-MMM-yyyy'),CarrierCode,FlightNumber ;]]></xml-property>
            <xml-property name="designerValues"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<model:DesignValues xmlns:design="http://www.eclipse.org/datatools/connectivity/oda/design" xmlns:model="http://www.eclipse.org/birt/report/model/adapter/odaModel">
  <Version>2.0</Version>
  <design:ResultSets derivedMetaData="true">
    <design:resultSetDefinitions>
      <design:resultSetColumns>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>FlightDate</design:name>
              <design:position>1</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>4000</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>FlightDate</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>FlightDate</design:label>
            <design:formattingHints>
              <design:displaySize>4000</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>CarrierCode</design:name>
              <design:position>2</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>3</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>CarrierCode</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>CarrierCode</design:label>
            <design:formattingHints>
              <design:displaySize>3</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>FlightNumber</design:name>
              <design:position>3</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>5</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>FlightNumber</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>FlightNumber</design:label>
            <design:formattingHints>
              <design:displaySize>5</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>weight</design:name>
              <design:position>4</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>3</design:nativeDataTypeCode>
            <design:precision>38</design:precision>
            <design:scale>1</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>weight</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>weight</design:label>
            <design:formattingHints>
              <design:displaySize>40</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
      </design:resultSetColumns>
      <design:criteria/>
    </design:resultSetDefinitions>
  </design:ResultSets>
</model:DesignValues>]]></xml-property>
        </oda-data-set>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="Data_Set_02" id="6">
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">CarrierShortName</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">CarrierShortName</text-property>
                    <text-property name="heading">CarrierShortName</text-property>
                </structure>
            </list-property>
            <list-property name="parameters">
                <structure>
                    <property name="name">param_1</property>
                    <property name="paramName">Carrier</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                    <property name="position">1</property>
                    <property name="allowNull">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">CarrierShortName</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">CarrierShortName</property>
                    <property name="nativeName">CarrierShortName</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[select CarrierShortName from Mst_Carrier where CarrierCode= ?]]></xml-property>
            <xml-property name="designerValues"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<model:DesignValues xmlns:design="http://www.eclipse.org/datatools/connectivity/oda/design" xmlns:model="http://www.eclipse.org/birt/report/model/adapter/odaModel">
  <Version>2.0</Version>
  <DataSetParameters>
    <parameter>
      <design:ParameterDefinition>
        <design:inOutMode>In</design:inOutMode>
        <design:attributes>
          <design:identifier>
            <design:name></design:name>
            <design:position>1</design:position>
          </design:identifier>
          <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
          <design:precision>3</design:precision>
          <design:scale>0</design:scale>
          <design:nullability>NotNullable</design:nullability>
        </design:attributes>
      </design:ParameterDefinition>
    </parameter>
  </DataSetParameters>
  <design:ResultSets derivedMetaData="true">
    <design:resultSetDefinitions>
      <design:resultSetColumns>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>CarrierShortName</design:name>
              <design:position>1</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>65</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>CarrierShortName</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>CarrierShortName</design:label>
            <design:formattingHints>
              <design:displaySize>65</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
      </design:resultSetColumns>
      <design:criteria/>
    </design:resultSetDefinitions>
  </design:ResultSets>
</model:DesignValues>]]></xml-property>
        </oda-data-set>
    </data-sets>
    <page-setup>
        <simple-master-page name="Simple MasterPage" id="2">
            <page-footer>
                <text id="3">
                    <property name="contentType">html</property>
                    <text-property name="content"><![CDATA[<value-of>new Date()</value-of>]]></text-property>
                </text>
            </page-footer>
        </simple-master-page>
    </page-setup>
    <body>
        <grid id="38">
            <column id="39"/>
            <row id="40">
                <cell id="41">
                    <data id="47">
                        <property name="fontWeight">bold</property>
                        <property name="dataSet">Data_Set_02</property>
                        <list-property name="boundDataColumns">
                            <structure>
                                <property name="name">CarrierShortName</property>
                                <text-property name="displayName">CarrierShortName</text-property>
                                <expression name="expression" type="javascript">dataSetRow["CarrierShortName"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                        </list-property>
                        <property name="resultSetColumn">CarrierShortName</property>
                    </data>
                </cell>
            </row>
            <row id="42">
                <cell id="43">
                    <label id="48">
                        <property name="fontWeight">bold</property>
                        <text-property name="text">Cargo-Import</text-property>
                    </label>
                </cell>
            </row>
            <row id="44">
                <cell id="45">
                    <table id="10">
                        <property name="dataSet">Data_Set_01</property>
                        <list-property name="boundDataColumns">
                            <structure>
                                <property name="name">date_arrival</property>
                                <text-property name="displayName">date_arrival</text-property>
                                <expression name="expression" type="javascript">dataSetRow["date_arrival"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                            <structure>
                                <property name="name">CarrierCode</property>
                                <text-property name="displayName">CarrierCode</text-property>
                                <expression name="expression" type="javascript">dataSetRow["CarrierCode"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                            <structure>
                                <property name="name">FlightNumber</property>
                                <text-property name="displayName">FlightNumber</text-property>
                                <expression name="expression" type="javascript">dataSetRow["FlightNumber"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                            <structure>
                                <property name="name">Weight</property>
                                <text-property name="displayName">Weight</text-property>
                                <expression name="expression" type="javascript">dataSetRow["Weight"]</expression>
                                <property name="dataType">decimal</property>
                            </structure>
                        </list-property>
                        <column id="34"/>
                        <column id="35"/>
                        <column id="36"/>
                        <column id="37"/>
                        <header>
                            <row id="11">
                                <cell id="12">
                                    <label id="13">
                                        <property name="backgroundColor">#666699</property>
                                        <property name="fontWeight">bold</property>
                                        <property name="color">#FFFFFF</property>
                                        <text-property name="text">Flight In Date 2</text-property>
                                    </label>
                                </cell>
                                <cell id="14">
                                    <label id="15">
                                        <property name="backgroundColor">#666699</property>
                                        <property name="fontWeight">bold</property>
                                        <property name="color">#FFFFFF</property>
                                        <text-property name="text">Arrival Flight Carrier</text-property>
                                    </label>
                                </cell>
                                <cell id="16">
                                    <label id="17">
                                        <property name="backgroundColor">#666699</property>
                                        <property name="fontWeight">bold</property>
                                        <property name="color">#FFFFFF</property>
                                        <text-property name="text">Arrival Flight Number</text-property>
                                    </label>
                                </cell>
                                <cell id="18">
                                    <label id="19">
                                        <property name="backgroundColor">#666699</property>
                                        <property name="fontWeight">bold</property>
                                        <property name="color">#FFFFFF</property>
                                        <text-property name="text">Sum Weight</text-property>
                                    </label>
                                </cell>
                            </row>
                        </header>
                        <detail>
                            <row id="20">
                                <cell id="21">
                                    <data id="52">
                                        <property name="resultSetColumn">date_arrival</property>
                                    </data>
                                </cell>
                                <cell id="23">
                                    <data id="53">
                                        <property name="resultSetColumn">CarrierCode</property>
                                    </data>
                                </cell>
                                <cell id="25">
                                    <data id="54">
                                        <property name="resultSetColumn">FlightNumber</property>
                                    </data>
                                </cell>
                                <cell id="27">
                                    <data id="55">
                                        <property name="resultSetColumn">Weight</property>
                                    </data>
                                </cell>
                            </row>
                        </detail>
                        <footer>
                            <row id="29">
                                <cell id="30"/>
                                <cell id="31"/>
                                <cell id="32"/>
                                <cell id="33"/>
                            </row>
                        </footer>
                    </table>
                </cell>
            </row>
        </grid>
    </body>
</report>
